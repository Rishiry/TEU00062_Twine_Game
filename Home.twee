:: StoryTitle
Home


:: StoryData
{
  "ifid": "A0B0FD5C-C8F2-4EE8-A02D-82658CB331FD",
  "format": "SugarCube",
  "format-version": "2.36.1",
  "start": "Awakening",
  "tag-colors": {
    "Don't-change": "red"
  },
  "zoom": 0.3
}


:: AcademicAndPersonalGrowthEnding {"position":"3375,5725","size":"100,100"}
Throughout the trials, solving old mysteries and developing expertise in skills enhanced your scholarly pursuits. Your newfound understanding sparks an internal awakening that permanently alters the trajectory of your academic and personal life.


:: AcademicPioneerEnding {"position":"1575,4625","size":"100,100"}
Your expertise lies in innovative education. The trial’s teachings lead you to hone a revolutionary approach to education which involves combining more traditional knowledge with modern technology. Your groundbreaking programs redefine education, equipping young minds with skills to navigate a complex world with agility and foresight.


:: AcademicPreservation [47] {"position":"325,3400","size":"100,100"}
!Scene: AcademicPreservation

Deciding to preserve the ancient scripts, you carefully store them.

[[Analyse the preserved scripts.->ManuscriptStudy]]
[[Secure the scripts.->ArtifactAnalysis]]

<<image "./images/image22.jpg">><<audio "thinking" play>>


:: AdvancedTrialProgress [49] {"position":"3475,4050","size":"100,100"}
!Scene: AdvancedTrialProgress

Applying the insights gained, you navigate through advanced sections of the trial.

[[Leverage these secrets to access restricted areas.->NewAreasUnlocked]]
[[Keep the secrets for personal use.->FinalSecretUnlocked]]

<<image "./images/image33.jpg">><<audio "startscreen" play>>


:: AlternativeEndingSearch [19] {"position":"1900,4325","size":"100,100"}
!Scene: AlternativeEndingSearch

Seeking an alternative, you explore other interpretations of the trials' outcomes.

[[Develop a theory that challenges the traditional understanding of the trials.->TheoryDevelopment]]
[[Gather support from other participants for a collective reinterpretation.->CollectiveReinterpretation]]

<<image "./images/image46.jpg">><<audio "suspense" play>>


:: AncientCivilizations [54] {"position":"525,3925","size":"100,100"}
!Scene: AncientCivilizations

An interactive display teaches you about the influence of ancient civilizations on modern trials.

[[Incorporate ancient wisdom into your strategies.->WisdomApplication]]
[[Create an educational module on ancient influences.->AcademicPreservation]]

<<image "./images/image59.jpg">><<audio "thinking" play>>


:: AncientRuinsDiscovery [56] {"position":"1325,1925","size":"100,100"}
!Scene: AncientRuinsDiscovery

Following ancient stone markers, you discover some new ruins.

[[Explore the ruins in-depth.->ArtifactDiscovery]]
[[Map the site for further exploration.->MapAssembly]]

<<image "./images/image15.jpg">><<audio "success" play>>


:: ArchiveEntry [26] {"position":"1800,700","size":"100,100"}
!Scene: ArchiveEntry

Entering 'The Archive of Shadows' reveals a space filled with artefacts and holographic displays.

[[Investigate the displays.->HolographicInvestigation]]
[[Examine the artefacts closely.->ArtifactAnalysis]]

<<image "./images/image19.jpg">><<audio "startscreen" play>>


:: ArenaEntry [12] {"position":"800,425","size":"100,100"}
!Scene: ArenaEntry

You seem to be transported to some sort of amphitheatre, filled with seeming real people all ready for a debate on 'The impact of digital life on human connection.'

[[Prepare your arguments for the debate.->DebatePreparation]]
[[Engage the audience for support.->AudienceEngagement]]

<<image "./images/image38.jpg">><<audio "startscreen" play>>


:: ArtifactAnalysis {"position":"1725,2775","size":"100,100"}
!Scene: ArtifactAnalysis

Analysing the artefacts, you piece together a narrative of historical trials.

[[Compile findings into a report.->ReportingSuccess]]
[[Use the artefacts to unlock further areas in the temple.->NewAreasUnlocked]]
<<audio "success" play>>


:: ArtifactDiscovery {"position":"50,1150","size":"100,100"}
!Scene: ArtifactDiscovery

You find carved stone pieces that create a map, potentially revealing the whole purpose of the Trial of Shadows. You add 'Carved Stone Map' to your inventory.

[[Assemble the map pieces.->MapAssembly]]
[[Take the pieces for analysis in the central chamber.->ChamberReexamination]]
<<audio "startscreen" play>>


:: AudienceEngagement {"position":"975,325","size":"100,100"}
Before the debate starts, you interact with the others, collecting their thoughts about the impact of digital life.

   <<link "Use wit and charm to win over the audience, making them receptive to your views." `either("PodiumInteraction", "ChamberReexamination")`>><</link>>

   <<link "Listen to their concerns and tailor your debate points to align with audience preferences." `either("PodiumInteraction", "DebatePreparation")`>><</link>>


:: Awakening [1] {"position":"525,50","size":"100,100"}
!Start Scene: The Awakening
<<image "./images/image30.jpg">>

You awaken in an unfamiliar dimly lit chamber. Before you stands an ancient podium with a screen illuminating the room. 'Welcome, Participant,' it flashes. 'Your elective begins now. The Trials of the Mind are located beyond these borders and offer an intellectual, brave, and creative challenge. Not only will your grades be determined by your choices, but so will your destiny.

<<if not $backpack.has("Mysterious Key")>>\
[[Examine the chamber for clues.->KeyDiscovery]]
<</if>>\
[[Interact with the podium.->PodiumInteraction]]

<<audio "startscreen" play>>


:: ChamberReexamination [11] {"position":"375,1475","size":"100,100"}
!Scene: ChamberReexamination

You notice a new symbol on the podium. Was that there before?

[[Investigate the new symbol.->NewTrialUnlocked]]
[[Select another original trial.->PodiumInteraction]]

<<image "./images/image14.jpg">><<audio "thinking" play>>


:: ClearingDiscovery {"position":"875,1125","size":"100,100"}
!Scene: ClearingDiscovery
A moonlit clearing reveals a stand with a glowing orb.
<<pickup $backpack "Glowing Orb" 1>>
<<notify 1s>>Found Glowing Orb.<</notify>>
[[Examine the orb.->OrbInspection]]
[[Continue with the orb.->ContinueWithOrb]]
<<audio "success" play>>


:: ClueSearching [62] {"position":"2100,6250","size":"100,100"}
!Scene: ClueSearching

You search for clues left by previous participants, finding items that could be useful.

[[Find a crucial item that aids in your trial.->ArtifactAnalysis]]
[[Gather all findings for a comprehensive clue compilation.->ReportingSuccess]]

<<image "./images/image35.jpg">><<audio "suspense" play>>


:: CollaborativeInitiativesEnding {"position":"1775,5025","size":"100,100"}
In the aftermath of the trials, you choose synergy over solitude, creating a pool of shared wisdom. Alongside fellow thinkers, you reframe the trials' legacies, you reinterpret the lessons from these trials, crafting a story that goes beyond personal experiences and builds a community united by mutual understanding and growth.


:: CollectiveReinterpretation [23] {"position":"1775,4700","size":"100,100"}
!Scene: CollectiveReinterpretation

Together with other participants from your college, you develop a reinterpretation of the trials that emphasises community and shared experiences.

[[Organise a room to discuss this interpretation with a broader audience.->GlobalVisionaryEnding]]
[[Create a collaborative book or documentary featuring multiple perspectives.->CollaborativeInitiativesEnding]]

<<image "./images/image47.jpg">><<audio "success" play>>


:: CompassCreation [36] {"position":"1025,6175","size":"100,100"}
!Scene: CompassCreation

Crafting a makeshift compass, you attempt to orient yourself in the unknown forest.

[[Use the compass to find a northward path.->NorthPathDiscovery]]
[[Use the compass to retrace your steps and ensure safety.->SafetyRetreat]]

<<image "./images/image53.jpg">><<audio "forest" play>>


:: ConflictResolution [48] {"position":"1250,6800","size":"100,100"}
!Scene: ConflictResolution

Using your acquired wisdom, you mediate a dispute among the trial participants.

[[Use the resolution as a model for future conflicts.->TrialConclusion]]
[[Document the conflict and resolution for academic study.->ReportingSuccess]]

<<image "./images/image24.jpg">><<audio "suspense" play>>


:: ContinueWithOrb {"position":"300,350","size":"100,100"}
!Scene: ContinueWithOrb

The orb’s light seems to reveal new paths.

[[Explore deeper using the orb’s light.->DeepForestExploration]]
[[Return to the chamber to use the orb on the new symbol.->NewTrialUnlocked]]
<<audio "thinking" play>>


:: DebatePreparation {"position":"850,625","size":"100,100"}
With all of the commotion stirring it is now the moment to voice your opinions.

Your Opening Speeching:
<<typesim "Digital life has dramatically transformed human connection by making it easier to stay in touch with friends and family, regardless of geographic distances. Platforms like social media and messaging apps ensure that we are never really far from our loved ones, maintaining relationships that might otherwise fade.">>\
   
  <<Opponent>>However, the quality of these connections is superficial at best. Digital interactions often replace deep, meaningful conversations with brief, impersonal exchanges. The constant presence of screens can alienate us from the physical world, weakening real-life social skills and deep emotional connections.<</Opponent>>

	Your Response:
  <<typesim "Yet, digital platforms also provide a space for communities that might not otherwise exist, supporting those who feel isolated or marginalized in their immediate physical environment. For example, many find invaluable support and understanding in online groups centered around specific challenges like mental health.">>\

    <<Opponent>>That's a valid point, but the paradox lies in our increased feelings of loneliness and anxiety as social media usage goes up. Studies have shown a correlation between prolonged screen time and increased rates of depression, especially among teens. It seems that digital connectivity, while vast, is ironically leading to greater emotional isolation.
    <</Opponent>>

  <<set $result to either(false, true)>>
<<if $result is false>>
   <<link "Unfortunately, it seems like you lost the debate." "ArenaEntry">><</link>>
<<else>>
   <<link "Seems like you won the debate!" `either("PodiumInteraction", "ChamberReexamination")`>><</link>><</if>>


  <</typesim>>\

<</typesim>>\


:: DeepForestExploration {"position":"425,800","size":"100,100"}
!Scene: DeepForestExploration

Deeper within the forest you encounter ancient ruins and hidden artefacts.

[[Search the ruins.->ArtifactDiscovery]]
[[Document the ruins' inscriptions.->DocumentingSuccess]]
<<audio "forest" play>>


:: DigitalArchiveAccess [31] {"position":"225,775","size":"100,100"}
!Scene: DigitalArchiveAccess

The digital archives offer a wealth of information.

[[Search for information on previous trial participants.->ParticipantHistory]]
[[Look up strategies for completing trials.->StrategyGuide]]

<<image "./images/image7.jpg">><<audio "success" play>>


:: DocumentingSuccess [41] {"position":"1050,2275","size":"100,100"}
!Scene: DocumentingSuccess

You successfully document the inscriptions and symbols found in the ruins.

[[Use the documented inscriptions to solve a puzzle.->ArtifactDiscovery]]
[[Keep the documents safe for future study.->ArtifactAnalysis]]

<<image "./images/image8.jpg">><<audio "success" play>>


:: DoorUnlock [24] {"position":"150,625","size":"100,100"}
!Scene: DoorUnlock

Upon using the Mysterious Key on the door, it swings open slowly, revealing a hidden library.

[[Explore the ancient texts for clues.->ManuscriptStudy]]
[[Access the digital archives for information on the trials.->DigitalArchiveAccess]]

<<image "./images/image62.jpg">><<audio "door" play>>


:: EthicalLeaderEnding {"position":"1350,4600","size":"100,100"}
As a shining example of integrity, your hardships throughout the trials motivate your desire to be an ethical leader. Your work to encourage moral decision-making has influenced your community, establishing new standards for behaviour and inspiring a shift toward more conscious leadership among others.


:: ExteriorInspection [43] {"position":"700,2525","size":"100,100"}
!Scene: ExteriorInspection

You examine the temple's exterior and uncover some engravings.

[[Decode the engravings to unlock the temple's secrets.->TempleEntry]]
[[Sketch the engravings for later.->DocumentingSuccess]]

<<image "./images/image5.jpg">><<audio "thinking" play>>


:: FinalReporting [20] {"position":"2525,5050","size":"100,100"}
!Scene: FinalReporting

You compile a comprehensive report of your findings.

[[Submit the report, highlighting the lessons learned.->AcademicAndPersonalGrowthEnding]]
[[Publish the report to share the knowledge of such trials.->GlobalImpactEnding]]

<<image "./images/image28.jpg">><<audio "thinking" play>>


:: FinalSecretUnlocked [17] {"position":"1675,3850","size":"100,100"}
!Scene: FinalSecretUnlocked

The relics activate a mechanism that reveals the ultimate purpose of the Trial.

[[Embrace this information and conclude the trial with newfound knowledge.->TrialConclusion]]
[[Reject the implications and attempt to find an alternative ending.->AlternativeEndingSearch]]

<<image "./images/image54.jpg">><<audio "suspense" play>>


:: ForestNavigation {"position":"1275,1150","size":"100,100"}
!Scene: ForestNavigation

Guided by the map you now have, you navigate the different forest paths.

[[Follow the map’s illuminated path.->ClearingDiscovery]]
[[Trust your instincts and venture off track.->OffPathChallenge]]
<<audio "forest" play>>


:: FurtherExploration {"position":"1700,2525","size":"100,100"}
!Scene: FurtherExploration

As you delve deeper into the temple's secrets, you find more artefacts and ancient scripts.

[[Gather artefacts and decode them.->ArtifactAnalysis]]
[[Study the ancient scripts for clues.->ManuscriptStudy]]
<<audio "startscreen" play>>


:: GameTitle {"position":"25,125","size":"100,100"}
The Trials


:: GlobalImpactEnding {"position":"2550,5275","size":"100,100"}
Armed with an array of insights from the trials, you emerge as a visionary. You channel the wisdom you have gained into global causes. Your actions trigger movements, shape policies, and encourage others to think critically about the interconnectedness of society, demonstrating the transformational potential of knowledge when applied on a worldwide scale.


:: GlobalVisionaryEnding {"position":"2000,4975","size":"100,100"}
From the echoes of the challenges you experienced in the trials, you step forth as a leader whose initiatives tackle the vast array of global issues. Your collaborative spirit and innovative strategies merge cultures and ideas from every inch of the globe, crafting a legacy of unity and progress that shapes the future.


:: GroveDiscovery [38] {"position":"2475,6700","size":"100,100"}
!Scene: GroveDiscovery

The rustling of leaves brings you to a secluded grove that possibly holds clues or items left by previous participants.

[[Search the grove for clues.->ClueSearching]]
[[Rest and reflect on your journey->Reflection]]

<<image "./images/image13.jpg">><<audio "leaves" play>>


:: HallExploration [44] {"position":"450,6750","size":"100,100"}
!Scene: HallExploration

As you explore the hall, you discover hidden chambers filled with historical artefacts.

[[Investigate the hidden chambers.->RelicDiscovery]]
[[Collect samples from the artefacts for analysis.->ArtifactAnalysis]]

<<image "./images/image6.jpg">><<audio "startscreen" play>>


:: HiddenPathDiscovery [57] {"position":"1800,6775","size":"100,100"}
!Scene: HiddenPathDiscovery

The alignment of trees leads you to a hidden path that could offer shortcuts or hidden dangers.


<<link "Take the hidden path." `either("TempleApproach", "SafetyRetreat")`>><</link>>
[[Mark the path for future exploration.->MapStudy]]

<<image "./images/image2.jpg">><<audio "forest" play>>


:: HolographicInvestigation [33] {"position":"1875,850","size":"100,100"}
!Scene: HolographicInvestigation

The holographic displays various aspects of human history and psychology.

[[Engage with a display about ancient civilizations.->AncientCivilizations]]
[[Interact with a puzzle display.->PsychologicalPuzzle]]

<<image "./images/image52.jpg">><<audio "thinking" play>>


:: IsolatedScholarEnding {"position":"3200,6425","size":"100,100"}
In solitude, your journey terminates. The trials have led you to isolation. Yet in the silence, your concentration intensifies, enriching your scholarly pursuits. Though as of yet unrecognised, your vast research remains a treasure mine of knowledge, ready to clear the way for future truth-seekers.


:: KeyDiscovery [2] {"position":"325,200","size":"100,100"}
!Scene: KeyDiscovery
<<image "./images/image3.jpg">>
You see a dim glow beneath a loose stone as your eyes adjust to the new light. It's an old key with symbols that could mean something dangerous or extremely valuable.
<<pickup $backpack "Mysterious Key" 1>>
<<notify 1s>>Found Mysterious Key.<</notify>>
[[Try using the key on the chamber’s locked door.->DoorUnlock]]
[[Return to the podium with the key.->PodiumInteraction]]

<<audio "thinking" play>>


:: KnowledgeApplication [21] {"position":"1325,4325","size":"100,100"}
!Scene: KnowledgeApplication

Reflecting on your journey, you plan how to apply the insights gained to real-world problems.

[[Develop a new educational program based on the trials' teachings.->AcademicPioneerEnding]]
[[Start a consultancy to help your college implement ethical decision-making practices.->EthicalLeaderEnding]]

<<image "./images/image11.jpg">><<audio "thinking" play>>


:: KnowledgeRecall [28] {"position":"1025,500","size":"100,100"}
!Scene: KnowledgeRecall

You attempt to recall related knowledge that might help you navigate the maze or solve its puzzles.

[[Apply your recalled knowledge to find a path.->MazeEnd]]
[[Realise you need more information and return to studying the walls.->MazeNavigation]]

<<image "./images/image58.jpg">><<audio "thinking" play>>


:: LabyrinthEntry [6] {"position":"1400,250","size":"100,100"}
!Scene: LabyrinthEntry

Entering the labyrinth, you face a maze of light with echoing puzzles. The symbol on the screen glows as you touch it, and suddenly, the chamber walls shift, revealing a maze constructed of shimmering light. Your task: navigate the maze and solve its puzzles.

[[Navigate the maze, seeking clues.->MazeNavigation]]
[[Use the map to find a shortcut(if you have it).->MazeShortcut]]

<<image "./images/image50.jpg">><<audio "crush" play>>


:: LoreLearning {"position":"1675,2250","size":"100,100"}
!Scene: LoreLearning

The murals show the guardians' efforts to seal away a powerful force.

[[Document the lore for your report.->ReportingSuccess]]
[[Continue exploring for some deeper insights.->FurtherExploration]]
<<audio "startscreen" play>>


:: ManuscriptStudy [13] {"position":"1200,2625","size":"100,100"}
!Scene: ManuscriptStudy

The scripts are dense with ancient information, possibly guiding the philosophy behind the trials.

[[Apply the wisdom to solve a current problem.->WisdomApplication]]
[[Store the scripts for further study.->AcademicPreservation]]

<<image "./images/image48.jpg">><<audio "startscreen" play>>


:: MapAssembly {"position":"1900,1775","size":"100,100"}
!Scene: MapAssembly

Attempting to assemble the map, you try to align the symbols based on what you remember from the ruins' inscriptions.

<<set _correct to [false, false, false, true]>>
<span id="solved">

Assemble the Map:
<<swap>>Piece 1<<onswap>>
	<<if swapCurrent() is 'Piece 3'>>
		<<set _correct[0] to true>>
	<<else>>
		<<set _correct[0] to false>>
	<</if>>
<</swap>>
<<swap>>Piece 2<<onswap>>
	<<if swapCurrent() is 'Piece 1'>>
		<<set _correct[1] to true>>
	<<else>>
		<<set _correct[1] to false>>
	<</if>>
<</swap>>
<<swap>>Piece 3<<onswap>>
	<<if swapCurrent() is 'Piece 2'>>
		<<set _correct[2] to true>>
	<<else>>
		<<set _correct[2] to false>>
	<</if>>
<</swap>>
<<swap>>Piece 4<<onswap>>
	<<if swapCurrent() is 'Piece 4'>>
		<<set _correct[3] to true>>
	<<else>>
		<<set _correct[3] to false>>
	<</if>>
<</swap>>


	@@#not-right;@@

  <<button "Check the map...">>
	  <<if not _correct.includes(false)>>
		  <<replace '#solved'>>
            ''The completed map shows a path leading to an ancient temple.''
            
            [[Follow the path.->TempleApproach]]
            [[Document the completed map.->DocumentingSuccess]]
          <</replace>>
	   <<else>>
	   		<<replace '#not-right'>>No, that's not it...<</replace>>
		<</if>>
  <</button>>
</span>



<<audio "thinking" play>>


:: MapCompleted {"position":"200,1600","size":"100,100"}
!Scene: MapCompleted

The completed map shows a path leading to an ancient temple.

[[Follow the path.->TempleApproach]]
[[Document the completed map.->DocumentingSuccess]]
<<audio "success" play>>


:: MapStudy [5] {"position":"1675,250","size":"100,100"}
!Scene: MapStudy

The map reveals coordinates for 'The Archive of Shadows,' a trial you did not see listed.

[[Find 'The Archive of Shadows'.->ArchiveEntry]]
[[Return to known trials.->PodiumInteraction]]

<<image "./images/image18.jpg">><<audio "startscreen" play>>


:: MazeEnd [9] {"position":"775,775","size":"100,100"}
!Scene: MazeEnd

You successfully exit the maze, relieved to be free at last.

[[Ready for a new challenge.->PodiumInteraction]]
[[Search the chamber for new elements.->ChamberReexamination]]

<<image "./images/image61.jpg">><<audio "success" play>>


:: MazeNavigation [7] {"position":"1150,350","size":"100,100"}
!Scene: MazeNavigation

Every turn you make, you are presented with a new riddle. Each one seems to be more challenging than the last.

[[Solve riddles through logic.->RiddleSolving]]
[[Try to recall relevant knowledge.->KnowledgeRecall]]

<<image "./images/image49.jpg">><<audio "suspense" play>>


:: MazeShortcut [8] {"position":"1600,1050","size":"100,100"}
!Scene: MazeShortcut

The map you collected seems to reveal a risky shortcut through the maze.

[[Take the shortcut.->MazeEnd]]
[[Stick to the known path.->MazeNavigation]]

<<image "./images/image42.jpg">><<audio "startscreen" play>>


:: MazeTrap [10] {"position":"1000,650","size":"100,100"}
!Scene: MazeTrap

You are now trapped and regretting your decision, a new holographic quiz blocks your path.

Options:
- A. Solve the quiz under pressure.
- B. Use the 'Cryptic Note' for hints

<<image "./images/image4.jpg">><<audio "suspense" play>>


:: NaturalLandmarkNavigation [35] {"position":"1175,6000","size":"100,100"}
!Scene: NaturalLandmarkNavigation

Using natural landmarks, you navigate through the dense forest.

[[Follow the ancient stone markers.->AncientRuinsDiscovery]]
[[Follow the alignment of trees.->HiddenPathDiscovery]]

<<image "./images/image41.jpg">><<audio "forest" play>>


:: NewAreasUnlocked [14] {"position":"1975,3300","size":"100,100"}
!Scene: NewAreasUnlocked

Unlocking new sections of the temple reveals a chamber dedicated to architects of the trials.

[[Explore the chamber.->RelicDiscovery]]
[[Document the chamber's designs.->ReportingSuccess]]

<<image "./images/image25.jpg">><<audio "startscreen" play>>


:: NewTrialUnlocked {"position":"575,325","size":"100,100"}
!Scene: NewTrialUnlocked

A new trial, 'The Trial of Shadows', now is revealed.

[[Enter The Trial of Shadows.->ShadowsEntry]]
[[Prepare further before proceeding.->PodiumInteraction]]

<<audio "thinking" play>>


:: NorthPathDiscovery [58] {"position":"550,5500","size":"100,100"}
!Scene: NorthPathDiscovery

Using the makeshift compass, you find a path leading northward.

[[Follow the north path.->ClearingDiscovery]]
[[Return to known trails.->MapStudy]]

<<image "./images/image31.jpg">><<audio "success" play>>


:: NoteGuidance {"position":"1825,6325","size":"100,100"}
!Scene: NoteGuidance

The note advises trusting not just your eyes but also the sounds within the forest.

[[Listen for sounds.->SoundGuidedPath]]
[[Focus on visual clues.->VisualPathChallenge]]
<<audio "forest" play >>


:: OffPathChallenge [29] {"position":"1675,1350","size":"100,100"}
!Scene: OffPathChallenge

Venturing off the illuminated path, you seem to find yourself in a new densely wooded area.


[[Navigate using natural landmarks->NaturalLandmarkNavigation]]
[[Create a makeshift compass->CompassCreation]]

<<image "./images/image60.jpg">><<audio "forest" play>>


:: OrbInspection [40] {"position":"625,900","size":"100,100"}
!Scene: OrbInspection

You examine the glowing orb closely.

[[Attempt to harness the energy of the orb.->ContinueWithOrb]]
[[Place the orb back carefully and continue exploring.->ClearingDiscovery]]

<<image "./images/image57.jpg">><<audio "startscreen" play>>


:: OrbPlacement {"position":"100,2100","size":"100,100"}
!Scene: OrbPlacement

You place the Orb and suddenly all of the murals adorning the walls animate, now revealing the story of guardians and a profound secret.

[[Interpret the murals' story.->LoreLearning]]
[[Retrieve the Orb and then exit.->OrbRetrieval]]
<<audio "success" play>>


:: OrbRetrieval [45] {"position":"350,2200","size":"100,100"}
!Scene: OrbRetrieval

After using the orb to reveal secrets, you decide to retrieve it in case you need it again.

[[Secure the orb for future use.->ChamberReexamination]]
[[Leave the orb and exit the temple.->TempleApproach]]

<<image "./images/image34.jpg">><<audio "thinking" play>>


:: OutcomeStudy [53] {"position":"2300,6050","size":"100,100"}
!Scene: OutcomeStudy

You study the outcomes of past trials, identifying the key factors for success.

[[Predict potential outcomes for your decisions.->WisdomApplication]]
[[Prepare a presentation on these findings.->ReportingSuccess]]

<<image "./images/image10.jpg">><<audio "thinking" play >>


:: ParticipantHistory [51] {"position":"2325,4050","size":"100,100"}
!Scene: ParticipantHistory

The digital archives reveal detailed histories of past trial participants.

[[Analyse the participants' strategies for your advantage.->StrategyGuide]]
[[Contact former participants for advice.->WisdomApplication]]

<<image "./images/image55.jpg">><<audio "thinking" play>>


:: PhilosophicalRealizationEnding {"position":"2725,4650","size":"100,100"}
Trials serve as a trigger for innovations in philosophy. You publish works that present fresh insights on reality and human consciousness, challenging the status quo. Your ideas initiate discussion that transform philosophical discourse and the pursuit of knowledge as they begin to infiltrate academic circles.


:: PodiumInteraction [3] {"position":"825,75","size":"100,100"}
!Scene: PodiumInteraction

The podium’s screen, which is now fully illuminated, displays symbols for six trials and prompts you to choose one.

[[Choose the Labyrinth symbol.->LabyrinthEntry]]
[[Choose the Arena symbol.->ArenaEntry]]
<<if $backpack.has("Mysterious Key")>>\
[[Use the 'Mysterious Key' on a locked compartment->SecretCompartment]]
<<else>>\
    There also seems to be a locked compartment. 
<</if>>\



<<image "./images/image40.jpg">><<audio "startscreen" play>>


:: PsychologicalPuzzle [55] {"position":"1025,7575","size":"100,100"}
!Scene: PsychologicalPuzzle

You engage with a psychological puzzle that challenges your perception.

[[Solve the puzzle using cognitive strategies.->ConflictResolution]]
[[Document the puzzle for a psychological study.->ReportingSuccess]]

<<image "./images/image1.jpg">><<audio "suspense" play>>


:: Reflection [63] {"position":"2725,6975","size":"100,100"}
!Scene: Reflection

You take a moment to reflect, gaining insights that could help in future challenges.

[[Gain a refreshed perspective.->WisdomApplication]]
[[Record your reflections.->ReportingSuccess]]

<<image "./images/image39.jpg">><<audio "startscreen" play >>


:: RelicAnalysis [50] {"position":"1675,3450","size":"100,100"}
!Scene: RelicAnalysis

You now examine the relics found in the chamber, deciphering their historical significance.

[[Use the relics to solve a chamber puzzle.->FinalSecretUnlocked]]
[[Catalog the relics for future exhibitions.->DocumentingSuccess]]

<<image "./images/image9.jpg">><<audio "thinking" play>>


:: RelicDiscovery [16] {"position":"2000,3850","size":"100,100"}
!Scene: RelicDiscovery

In the chamber, you find relics that resonate with the items in your possession, possibly offering a way to complete the trial.

[[Combine the relics to unlock a final secret.->FinalSecretUnlocked]]
[[Take the relics for further analysis.->RelicAnalysis]]

<<image "./images/image44.jpg">><<audio "success" play>>


:: ReportingSuccess [46] {"position":"2950,6325","size":"100,100"}
!Scene: ReportingSuccess

You compile a report of your findings, ready to share with those who can further your research.

[[Submit the report to a scholarly council.->AcademicAndPersonalGrowthEnding]]
[[Keep the report confidential for personal advantage.->IsolatedScholarEnding]]

<<image "./images/image29.jpg">><<audio "succcess" play>>


:: RiddleFailure [34] {"position":"1250,725","size":"100,100"}
!Scene: RiddleFailure

Failing to solve the riddle has consequences. The walls of the maze close in slightly.

[[Attempt the riddle again.->RiddleSolving]]
[[Decide to backtrack and find another path.->MazeNavigation]]

<<image "./images/image63.jpg">><<audio "crush" play>>


:: RiddleSolving [27] {"position":"2050,650","size":"100,100"}
!Scene: RiddleSolving

Each riddle is etched into the walls of the maze. 

Options:
- A. Solve a riddle based on historical knowledge. 
- B. Use the 'Cryptic Note' for hints,

<<image "./images/image43.jpg">><<audio "thinking" play>>


:: RuinsRevisit [42] {"position":"100,3050","size":"100,100"}
!Scene: RuinsRevisit

Returning to the ruins, you find overlooked details that could be crucial for solving the trials.

[[Examine the newly discovered details.->MapAssembly]]
[[Document these details for further analysis.->DocumentingSuccess]]

<<image "./images/image32.jpg">><<audio "suspense" play>>


:: SafetyRetreat [59] {"position":"1175,5500","size":"100,100"}
!Scene: SafetyRetreat

Realizing the hidden path is too dangerous, you wisely decide to retreat.

[[Use the retreat to plan a safer route.->ForestNavigation]]
[[Set up warnings for future travelers.->ArtifactAnalysis]]

<<image "./images/image51.jpg">><<audio "startscreen" play>>


:: SecretCompartment [4] {"position":"1325,75","size":"100,100"}
!Scene: SecretCompartment

Using the key you found on the hidden compartment reveals a holographic map accompanied with a cryptic note indicating a hidden trial.

<<pickup $backpack "Holographic Map" 1>>
<<pickup $backpack "Cryptic Note" 1>>
<<notify 1s>>Found Holographic Map.<</notify>>
<<notify 1s>>Found Cryptic Note.<</notify>>



[[Continue with a known trial.->PodiumInteraction]]
[[Examine the holographic map for hidden paths.->MapStudy]]
[[Insert the key into a newly revealed slot.->NewTrialUnlocked]]
[[Browse the unlocked trial information.->TrialInfoReview]]


<<image "./images/image27.jpg">><<audio "whisper" play>>


:: ShadowsEntry {"position":"275,525","size":"100,100"}
!Scene: ShadowsEntry

You are now teleported to an ancient forest of sorts.

[[Venture into the forest with your holographic map.->ForestNavigation]]
[[Consult the Cryptic Note for guidance.->NoteGuidance]]
<<audio "forest" play>>


:: SoundGuidePath [30] {"position":"1925,1300","size":"100,100"}
!Scene: SoundGuidedPath

Following the sounds of nature, you follow subtle cues to guide you.

Options:
- A. Follow the sound of water.
- B. Follow the rustling of leaves. 

<<image "./images/image26.jpg">><<audio "forest" play>>


:: SoundGuidedPath {"position":"1950,6125","size":"100,100"}
The note advises trusting not just your eyes but also the sounds with the forest.

[[Listen for sounds.->SoundGuidedPath]]
[[Focus on visual clues.->VisualPathChallenge]]


:: StoryInit {"position":"175,0","size":"100,100"}
<<cacheaudio "startscreen" "./music/startscreen.mp3">>
<<cacheaudio "whisper" "./music/whisper.mp3">>
<<cacheaudio "suspense" "./music/suspense.mp3">>
<<cacheaudio "thinking" "./music/suspense.mp3">>
<<cacheaudio "crush" "./music/crush.mp3">>
<<cacheaudio "success" "./music/success.mp3">>
<<cacheaudio "forest" "./music/forest.mp3">>
<<cacheaudio "door" "./music/door.mp3">>
<<cacheaudio "leaves" "./music/leaves.mp3">>
<<cacheaudio "waterfall" "./music/waterfall.mp3">>

<<character 'Opponent' 'images/opponent.jpg'>>

<<newinv $backpack>>


:: StoryInterface [Don't-change] {"position":"25,0","size":"100,100"}
<!-- SIDEBAR -->

<div id="sidebar">
  <div class="sidebar-header">
	<div id="sidebar-title">The Trials</div>
	  <div></div>
	  
	  <h1 class="story-title" data-passage="The Trials"></h1>
	  
	  <!-- MENU TOGGLE ICON -->
	  <div class="sidebar-toggle">
	 	 <span id="sidebar-toggle-icon" class="lnr lnr-menu-circle"></span>
	  </div>
  	</div>
	
<!-- HISTORY BUTTONS THAT ALLOW USER TO GO BACKWARDS AND FORWARDS -->
<!-- COMMENT THESE OUT IF YOU DON'T WANT THEM IN YOUR GAME -->
  <div class="sidebar-history-nav">
	  <span id="backwards-button" class="lnr lnr-arrow-left"></span>
	  <span id="forwards-button" class="lnr lnr-arrow-right"></span>
  </div>

	<div id="sidebar-body">
	
	  <!-- GAME LOGO IMAGE -->
	  <div class="story-logo" data-passage="storyLogo"></div>
	  
	  <!-- AUTHOR NAME -->
	  <h2 class="story-author" data-passage="storyAuthor"></h2>

	<nav class="sidebar-nav">
	  <ul class="story-tools">
		<li>
		<span id="restart-button" class="lnr lnr-redo"></span>
		<span class="tooltiptext">Restart</span>
		</li>
		<li>
		<span id="saves-button" class="lnr lnr-download"></span>
		<span class="tooltiptext">Saves</span>
		</li>
		<li>
		<span id="settings-button" class="lnr lnr-cog"></span>
		<span class="tooltiptext">Settings</span>
		</li>
	  </ul>

	  <ul class="story-menu" data-passage="storyMenu">
	  </ul>
	</nav>

	<nav id="Members">
	  <p>Members: Leah Weldon</p>
	  <ul data-passage="socialMedia">
	  </ul>
	</nav>
  </div> <!-- SIDEBAR-BODY END TAG -->
</div> <!-- SIDEBAR END TAG -->
  
 <div id="story" role="main">
  <div id="passages">
  <div id="passage-start" data-passage="start" class="passage">

  </div>
  </div>
</div>


:: StrategyGuide [52] {"position":"2775,4000","size":"100,100"}
!Scene: StrategyGuide

The archives include a hidden guide on trial strategies that seem to have been compiled by previous participants.

[[Apply a recommended strategy in your next challenge.->AdvancedTrialProgress]]
[[Keep the guide.->PodiumInteraction]]

<<image "./images/image12.jpg">><<audio "success" play>>


:: SymbolDeciphering [60] {"position":"2250,4325","size":"100,100"}
!Scene: SymbolDeciphering

You attempt to decipher the ancient symbols.

[[Successfully decipher the symbols, revealing a secret passage.->HiddenPathDiscovery]]
[[Struggle with the translation, needing more research.->ManuscriptStudy]]

<<image "./images/image36.jpg">><<audio "thinking" play>>


:: TempleApproach {"position":"425,1700","size":"100,100"}
!Scene: TempleApproach

You slowly approach the temple. Relics on the doors seem to resonate with your map.

[[Use the Carved Stone Map to unlock the door.->TempleEntry]]
[[Examine the temple's exterior for clues.->ExteriorInspection]]
<<audio "thinking" play>>


:: TempleEntry {"position":"200,1875","size":"100,100"}
!Scene: TempleEntry

The doors swing open to a vast hall filled with murals and artefacts. A pedestal at the end awaits the Glowing Orb.

[[Place the Glowing Orb on the pedestal.->OrbPlacement]]
[[Explore for additional artefacts.->HallExploration]]
<<audio "door" play>>


:: TheoryDevelopment [22] {"position":"2475,4725","size":"100,100"}
!Scene: TheoryDevelopment

You propose an alternative theory that challenges conventional interpretations, suggesting a deeper and possibly darker purpose behind the trials.

[[Present your theory at a college, sparking debate.->PhilosophicalRealizationEnding]]
[[Write your college report that explores this theory in detail.->IsolatedScholarEnding]]

<<image "./images/image28.jpg">><<audio "suspense" play>>


:: TrialConclusion [18] {"position":"1425,3675","size":"100,100"}
!Scene: TrialConclusion

With all secrets unveiled, you reflect on the trials' teachings.

[[Prepare a detailed report on your experiences and findings.->FinalReporting]]
[[Plan your next steps in applying this knowledge outside the trial.->KnowledgeApplication]]

<<image "./images/image21.jpg">><<audio "startscreen" play>>


:: TrialInfoReview [32] {"position":"1125,200","size":"100,100"}
!Scene: TrialInfoReview

With the podium unlocked, you can access detailed descriptions and historical outcomes of each trial, giving you a better understanding of what to expect and how to prepare.

[[Study the outcomes of past trials.->OutcomeStudy]]
[[Examine the list of available trials.->PodiumInteraction]]

<<image "./images/image12.jpg">><<audio "suspense" play>>


:: VisualPathChallenge [39] {"position":"1525,6050","size":"100,100"}
!Scene: VisualPathChallenge


<<dyslexia>>
Relying on visual cues, you navigate and decipher natural formations.
<</dyslexia>>

[[Interpret the natural formations.->ClearingDiscovery]]
[[Realize the path may be misleading and return to relying on sound.->NoteGuidance]]

<<image "./images/image20.jpg">><<audio "thinking" play>>


:: WaterSampleAnalysis [61] {"position":"3075,4300","size":"100,100"}
!Scene: WaterSampleAnalysis

You collect and analyze water samples from the waterfall.

[[Use the findings to enhance your survival skills.->AdvancedTrialProgress]]
[[Prepare a report on the ecological impact.->ReportingSuccess]]

<<image "./images/image37.jpg">><<audio "waterfall" play>>


:: WaterfallDiscovery [37] {"position":"2825,4450","size":"100,100"}
!Scene: WaterfallDiscovery

Following the sound of water leads you to a breathtaking waterfall with hidden symbols on the nearby rocks.

[[Decipher the symbols.->SymbolDeciphering]]
[[Collect water samples.->WaterSampleAnalysis]]

<<image "./images/image17.jpg">><<audio "waterfall" play


:: WisdomApplication [15] {"position":"800,3325","size":"100,100"}
!Scene: WisdomApplication

Utilising ancient wisdom, you address a current challenge within the trial. This could affect the outcome.

[[Implement the wisdom in resolving a conflict.->ConflictResolution]]
[[Use the insights to advance through the trial.->AdvancedTrialProgress]]

<<image "./images/image16.jpg">><<audio "thinking" play>>


:: storyAuthor {"position":"25,250","size":"100,100"}
By Group A :)


:: storyLogo {"position":"150,125","size":"100,100"}
<img  src="./images/logo.png" alt="Story Logo">


:: StoryScript [script]
// TO IMPORT STYLES - LINEAR ICONS + GOOGLE FONT MONTSERRAT & MERRIWEATHER
importStyles(
	"https://cdn.linearicons.com/free/1.0.0/icon-font.min.css",
	"https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,300;0,400;0,700;0,900;1,300;1,400;1,700;1,900&family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");

// SETTING ONCLICK FUNCTIONS FOR BUTTONS AS SOON AS PAGE IS LOADED
$(document).ready(function() {
	$("#sidebar-toggle-icon").click(function(){
		$("#sidebar").toggleClass("toggled");
	});
	
		$("#saves-button").click(function() {
		UI.saves();
	});
	
	$("#settings-button").click(function() {
		UI.settings();
	});
	
	$("#restart-button").click(function() {
		UI.restart();
	});
	
	$("#backwards-button").click(function() {
	Engine.backward();
});

	$("#forwards-button").click(function() {
	Engine.forward();
});
	
	$("#ui-dialog-close").html('<span class="lnr lnr-cross"></span>');
	
	console.log(UIBar.stow());
	
});

// MAKING SURE RETURN TO GAME LINKS DON'T CREATE A LOOP
$(document).on(":passagestart", function() {
	if (!tags().includes("noreturn")) {
		/* If it doesn't, then set $return to the current passage name. */
		State.variables.return = passage();
	}	
});

// MAKING SURE PAGE SCROLLS TO TOP ON LONG PASSAGES
$(document).on(":passagedisplay", function() {
	$("#story").scrollTop(0);
});

// POPULATING SETTINGS

// CHANGE FONT FAMILY
var settingFontFamily = ["Montserrat", "Merriweather", "Open Dyslexic"];
var setFont = function() {
	var passages = document.getElementById("passages");
	switch (settings.fontFamily) {
		case "Montserrat":
			passages.style.fontFamily = "'Montserrat', sans-serif";
			break;
	}
	switch (settings.fontFamily) {
		case "Merriweather":
			passages.style.fontFamily = "'Merriweather', serif";
			break;
	}
	switch (settings.fontFamily) {
		case "Open Dyslexic":
			passages.style.fontFamily = "'Dyslexic', serif";
			break;
	}
};

Setting.addList("fontFamily", {
	label		: "Change font",
	list		: settingFontFamily,
	onInit		: setFont,
	onChange	: setFont
});

// end change font family

// CHANGE FONT SIZE
var settingFontSize = ["16px", "18px", "20px", "22px", "24px"];
var setFontSize = function() {
	switch (settings.fontSize) {
		case "16px":
			passages.style.fontSize = "16px";
			break;
	}
	switch (settings.fontSize) {
		case "18px":
			passages.style.fontSize = "18px";
			break;
	}
	switch (settings.fontSize) {
		case "20px":
			passages.style.fontSize = "20px";
			break;
	}
	switch (settings.fontSize) {
		case "22px":
			passages.style.fontSize = "22px";
			break;
	}	
	switch (settings.fontSize) {
		case "24px":
			passages.style.fontSize = "24px";
			break;
	}
};

Setting.addList("fontSize", {
	label		: "Change font size",
	list		: settingFontSize,
	onInit		: setFontSize,
	onChange	: setFontSize
});

// CHANGE THEME
var themeList = ["Light Theme", "Dark Theme"];
var setTheme = function() {
	var html = $("html");
	
	html.removeClass("dark");
	
	switch(settings.theme) {
		case "Dark Theme":
			html.addClass("dark");
			break;
	}
};

Setting.addList("theme", {
	label			: "Change theme",
	list			: themeList,
	onInit		:	setTheme,
	onChange	: setTheme
  

 
});


// continue.min.js, for SugarCube 2, by Chapel
// v1.0.1, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;!function(){"use strict";var n=["a",":button",'*[role="button"]',".continue-macro-ignore","#ui-bar","#ui-dialog"],t=0;function o(){$(document).on("click.continue-macro keyup.continue-macro",n.join(", "),(function(n){n.stopPropagation()}))}function e(){if(State.length>0)return!1;var t=[].slice.call(arguments).flatten();return n=n.concat(t),!0}function c(n,o){var e=function(){var n="."+Date.now().toString(36)+"-"+t;return t++,n}();if(o&&"function"==typeof o){var c="click.continue-macro"+e;n&&(c=c+" keyup.continue-macro"+e),$(document).one(c,(function(){o.call(),$(document).off(e)}))}}prehistory["%%continue-expiration"]=function(){t=0},$(document).one(":passagerender",(function(){o()})),Macro.add("ignore",{handler:function(){if(!e(this.args))return this.error("the <<ignore>> macro should only be run from StoryInit or equivalent.")}}),Macro.add("cont",{tags:null,handler:function(){var n,t=this.args.includes("append"),o=this.args.includesAny("key","keypress","press","button"),e=this.payload[0].contents;t&&(n=$(document.createElement("span")).addClass("macro-"+this.name).appendTo(this.output)),c(o,this.createShadowWrapper((function(){t&&n&&n instanceof $?n.wiki(e):$.wiki(e)})))}}),setup.cont=c,setup.cont.ignore=e,setup.cont.reset=function(){var t=[].slice.call(arguments).flatten();n=n.concat(t),$(document).off(".continue-macro"),o()},window.cont=window.cont||setup.cont}();
// end continue.min.js
// swap-macro-set.min.js, for SugarCube 2, by Chapel
// v1.1.0, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;!function(){"use strict";var t=!0,a=!0,e="violet",s="red",r="swappable";setup.swap=setup.swap||{};var n=null;function i(a){var e=function(){return a};setup.swap.current=e,t&&(window.swapCurrent=e)}function o(a,o){var p=$(document.createElement("span"));return $(document.createElement("a")).wiki(a).css("color",e).attr({"data-swap-flag":"false","data-orig-content":a,"data-wiki-code":o||""}).addClass(r).appendTo(p).ariaClick((function(a){a.preventDefault();var r=$(this);if("true"===r.attr("data-swap-flag"))r.attr("data-swap-flag","false").css("color",e),n=null;else if(n){var o=n.text(),p=r.text(),l=n.attr("data-wiki-code"),c=r.attr("data-wiki-code");n.attr("data-swap-flag","false").css("color",e).empty().wiki(p),r.attr("data-swap-flag","false").css("color",e).empty().wiki(o),l&&"string"==typeof l&&l.trim()&&(i(p),$.wiki(l)),c&&"string"==typeof c&&c.trim()&&(i(o),$.wiki(c)),setup.swap.current&&"function"==typeof setup.swap.current&&delete setup.swap.current,t&&window.swapCurrent&&"function"==typeof window.swapCurrent&&delete window.swapCurrent,n=null}else n=r,r.attr("data-swap-flag","true").css("color",s)})),p}function p(){n=null,$("a."+r).each((function(){var t=$(this);t.empty().wiki(t.attr("data-orig-content")).attr("data-swap-flag","false").css("color",e)}))}Macro.add("swap",{tags:["onswap"],skipArgs:!0,handler:function(){var t=this.payload[0].contents,a=this.payload[1]?this.payload[1].contents:"",e=this.output,s=this.name;o(t,a).addClass("macro-"+s).appendTo(e)}}),Macro.add("resetswap",{handler:function(){var t=this.args&&this.args[0]&&"string"==typeof this.args[0]?this.args[0]:"Reset";$(document.createElement(a?"button":"a")).wiki(t).ariaClick({label:"Reset all swappable elements."},(function(t){t.preventDefault(),p()})).appendTo(this.output)}}),setup.swap.create=o,setup.swap.reset=p}();
// end swap-macro-set.min.js
// fs.min.js, for SugarCube 2, by Chapel
// v1.1.0, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;!function(){function t(t){return console.error(t),null}function e(e){try{return JSON.stringify(e)}catch(e){return t(e)}}function r(r){try{var a;if(void 0===r)return null;if(null!=(a="string"!=typeof r?e(r):r))return LZString.compressToBase64(a)}catch(e){return t(e)}}function a(e){try{return LZString.decompressFromBase64(e)}catch(e){return t(e)}}function n(e){try{return JSON.parse(e)}catch(r){try{return JSON.parse(a(e))}catch(e){return t(e)}}}function i(e,r){try{if("$"!==r[0]&&"_"!==r[0])throw new Error("Invalid stateful variable");State.setVar?State.setVar(r,clone(e)):"$"===r[0]?State.variables[r.substr(1)]=clone(e):State.temporary[r.substr(1)]=clone(e)}catch(e){return t(e)}}function s(r,a){if("string"!=typeof a&&(a=e(a)),null!=a){(r=r&&"string"==typeof r?Util.slugify(r.trim()).toLowerCase():"file.twinedata").includes(".")||(r+=".twinedata");try{saveAs(new Blob([a],{type:"text/plain;charset=UTF-8"}),r)}catch(e){return t(e)}}}function o(e){var r=e.target.files[0],s=new FileReader,o=e.storyVar||"$fileData",c=e.dataType||"text";$(s).on("load",(function(e){try{var r=e.currentTarget;if(!r.result)return;var s=function(t,e){if(null==e)return null;switch(t){case"json":return n(e);case"base64":case"b64":case"64":return n(a(e));default:return e}}(c,r.result);i(s,o),$(document).trigger({type:":import-macro",success:!0,data:clone(s),raw:r.result,storyVar:o})}catch(e){return i(null,o),$(document).trigger({type:":import-macro",success:!1,data:null,raw:null,storyVar:o}),t(e)}})),s.readAsText(r)}function c(t,e,r,a,n){var i,s=function(t,e,r,a){var n=$(document.createElement(a?"a":"button")).wiki(t),i=$(document.createElement("label")).attr("for","file-import").addClass("upload-file").append(n),s=$(document.createElement("input")).attr({id:"file-import",type:"file","data-format":r}).css("display","none").on("change",(function(t){o(Object.assign(clone(t),{storyVar:e,dataType:$(this).attr("data-format")}))})),c=$(document.createElement("span")).append(i,s);return n.ariaClick((function(){i.trigger("click")})),c}(e,r,a,n);i=t&&"string"==typeof t?$(t):t||"#passages",s.appendTo(i)}setup.fileSystem={config:{defaultText:"Import",renderAsLink:!1},JSON:{stringify:e,parse:n},b64:{compress:r,decompress:a},toState:i,toFile:s,fromFile:o},window.Chapel=window.Chapel||{},Chapel.fileSystem=Chapel.fileSystem||setup.fileSystem,Macro.add("import",{handler:function(){var t=this.output,e=this.args[2],r=this.args[0],a=this.args[1];if(e&&"string"==typeof e||(e=setup.fileSystem.config.defaultText),!r||"string"!=typeof r||"$"!==r[0]&&"_"!==r[0])return this.error("Invalid variable name.");c(t,e,r,a=a&&"string"==typeof a?a.trim():"text",setup.fileSystem.config.renderAsLink)}}),Macro.add("export",{handler:function(){var t=this.args[0],a=this.args[1],n=this.args[2];if(!t)return this.error("No data to save...");n=n&&"string"==typeof n?n.trim():"text",function(t,a,n){var i;switch(n){case"json":i=e(t);break;case"base64":case"b64":case"64":i=r(e(t)||t);break;default:i="string"==typeof t?t:e(t)}s(a,i)}(t,a=a&&"string"==typeof a?a.trim():"file.twinedata",n)}})}();
// end fs.min.js
// message-macro.min.js, for SugarCube 2, by Chapel
// v1.0.1, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;setup.messageMacro={},setup.messageMacro.default="Help",Macro.add("message",{tags:null,handler:function(){var e=this.payload[0].contents,a=$(document.createElement("span")),s=$(document.createElement(this.args.includes("btn")?"button":"a")),t=$(document.createElement("span"));s.wiki(this.args.length>0&&"btn"!==this.args[0]?this.args[0]:setup.messageMacro.default).ariaClick(this.createShadowWrapper((function(){a.hasClass("open")?t.css("display","none").empty():t.css("display","block").wiki(e),a.toggleClass("open")}))),a.attr("id","macro-"+this.name+"-"+this.args.join("").replace(/[^A-Za-z0-9]/g,"")).addClass("message-text").append(s).append(t).appendTo(this.output)}});
// end message-macro.min.js
// mouseover.min.js, for SugarCube 2, by Chapel
// v1.0.1, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;Macro.add("mouseover",{tags:["onhover","onmouseover","onmousein","onmouseenter","onmouseout"],skipArgs:!0,handler:function(){if(this.payload.length<2)return this.error("No event tag used.");var e={mouseover:[],mousein:[],mouseout:[]},o=$(document.createElement("span")).addClass("macro-"+this.name).wiki(this.payload[0].contents).appendTo(this.output);this.payload.forEach((function(o){switch(o.name){case"onhover":case"onmouseover":e.mouseover.push(o.contents);break;case"onmousein":case"onmouseenter":e.mousein.push(o.contents);break;case"onmouseout":e.mouseout.push(o.contents);break;default:return}})),e.mouseover.length&&o.on("mouseover",this.createShadowWrapper((function(o){$.wiki(e.mouseover.join(" "))}))),e.mousein.length&&o.on("mouseenter",this.createShadowWrapper((function(o){$.wiki(e.mousein.join(" "))}))),e.mouseout.length&&o.on("mouseout",this.createShadowWrapper((function(o){$.wiki(e.mouseout.join(" "))})))}});
// end mouseover.min.js
// css-macro.min.js, for SugarCube 2, by Chapel
// v1.0.0, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;!function(){"use strict";function t(t){if(t.length%2!=0)return"Style rules should be a list of key/value pairs; you've passed an odd number.";var r={};return t.forEach((function(e,n){n%2==0&&(r[e]=t[n+1])})),r}function r(t,r){try{return"string"==typeof r?r:(t instanceof jQuery||(t=$(t)),t.css(r))}catch(t){return t.message}}Macro.add("css",{handler:function(){var e=function(){try{var e,n=[].slice.call(arguments).flatten(),s=n.shift();return"string"==typeof n[0]?e=t(n):"object"==typeof n[0]&&(e=clone(n[0])),r(s,e)}catch(t){return t.message}}(this.args);if("string"==typeof e)return this.error(e)}})}();
// end css-macro.min.js
// dialog-api-macro-set.min.js, for SugarCube 2, by Chapel
// v1.3.0, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;Macro.add("dialog",{tags:["onopen","onclose"],handler:function(){var t="",s=null,n=null,o=this.args.length>0?this.args[0]:"",e=this.args.length>1?this.args.slice(1).flatten():[];this.payload.forEach((function(o,e){0===e?t=o.contents:"onopen"===o.name?s=s?s+o.contents:o.contents:n=n?n+o.contents:o.contents})),e.push("macro-"+this.name),Dialog.setup(o,e.join(" ")),Dialog.wiki(t),s&&"string"==typeof s&&s.trim()&&$(document).one(":dialogopened",(function(){$.wiki(s)})),n&&"string"==typeof n&&n.trim()&&$(document).one(":dialogclosed",(function(){$.wiki(n)})),Dialog.open()}}),Macro.add("popup",{handler:function(){if(this.args.length<1)return this.error("need at least one argument; the passage to display");if(!Story.has(this.args[0]))return this.error("the passage "+this.args[0]+"does not exist");var t=this.args[0],s=this.args.length>1?this.args[1]:"",n=this.args.length>2?this.args.slice(2).flatten():[];n.push("macro-"+this.name),Dialog.setup(s,n.join(" ")),Dialog.wiki(Story.get(t).processText()),Dialog.open()}}),Macro.add("dialogclose",{skipArgs:!0,handler:function(){Dialog.close()}});
// end dialog-api-macro-set.min.js
// fading-macro-set.min.js, for SugarCube 2, by Chapel
// v1.1.0, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;Macro.add("fadein",{tags:null,handler:function(){var t,a,s=$(document.createElement("span")),e=this.payload[0].contents;if(0===this.args.length)return this.error("no arguments given");t=Util.fromCssTime(this.args[0]),a=this.args.length>1?Util.fromCssTime(this.args[1]):0,s.wiki(e).addClass("macro-"+this.name).appendTo(this.output).hide().delay(a).fadeIn(t)}}),Macro.add("fadeout",{tags:null,handler:function(){var t,a,s=$(document.createElement("span")),e=this.payload[0].contents;if(0===this.args.length)return this.error("no arguments given");t=Util.fromCssTime(this.args[0]),a=this.args.length>1?Util.fromCssTime(this.args[1]):0,s.wiki(e).addClass("macro-"+this.name).appendTo(this.output).delay(a).fadeOut(t)}});
// end fading-macro-set.min.js
// ui-macro.min.js, for SugarCube 2, by Chapel
// v1.0.0, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;!function(){var s={update:UIBar.setStoryElements,stow:UIBar.stow,unstow:UIBar.unstow,toggle:function(){$("#ui-bar").hasClass("stowed")?UIBar.unstow():UIBar.stow()},hide:function(){$("#ui-bar").css("display","none")},show:function(){$("#ui-bar").css("display","block")},kill:function(){$("#ui-bar").css("display","none"),$("#story").css("margin-left","2.5em")},restore:function(){$("#ui-bar").css("display","block"),$("#story").css("margin-left","20em")},jump:UI.jumpto,saves:UI.saves,restart:UI.restart,settings:UI.settings,share:UI.share,aliases:{refresh:"update",reload:"update",destroy:"kill",revive:"restore",jumpto:"jump",save:"saves",load:"saves",setting:"settings",sharing:"share"}},r=Object.keys(s);function t(t){return t&&"string"==typeof t?function(s){return r.includes(s)}(t=t.toLowerCase().trim())||(t=function(r){return s.aliases[r]||null}(t))?(s[t](),!1):'Command "'+t+'" is not a valid command.':"Command is not a string."}Macro.add("ui",{handler:function(){Array.isArray(this.args)&&this.args.length||this.error("No commands passed to macro.");var s,r=function(s){if(!Array.isArray(s))return"Command list error.";var r=[];return s.forEach((function(s){r.push(t(s))})),r}(this.args.flatten());s=(r=r.filter((function(s){return"string"==typeof s}))).join(" "),r.length&&s&&this.error(s)}})}();
// end ui-macro.min.js
// preload.min.js, for SugarCube 2, by Chapel
// v1.0.0, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;!function(){"use strict";function t(t,r){var e=0,o=t.length;if(0===o)throw new Error("No URLs to preload!");t.forEach((function(t){!function(t,r){var e=new Image;e.onload=r,e.onerror=r,e.src=t}(t,(function(){++e===o&&r()}))}))}function r(){return State.length<=0}function e(){var e=[].slice.call(arguments).flatten(),o=!!r()&&LoadScreen.lock();return t(e,(function(){o&&LoadScreen.unlock(o)})),o}setup.preload=e,setup.preload.force=!1,Macro.add("preload",{handler:function(){if(!r()&&!setup.preload.force)return this.error("Attempting to preload images outside of `StoryInit` or similar can cause performance issues. Set `setup.preload.force` to `true` if you want to do it anyway.");e(this.args.flatten().filter((function(t){return"string"==typeof t})))}})}();
// end preload.min.js
// articles.min.js, for SugarCube 2, by Chapel
// v1.0.0, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;!function(){"use strict";var e=new Map,r=["eunuch","eucalyptus","eugenics","eulogy","euphemism","euphony","euphoria","eureka","european","euphemistic","euphonic","euphoric","euphemistically","euphonically","euphorically","heir","heiress","herb","homage","honesty","honor","honour","hour","honest","honorous","honestly","hourly","one","ouija","once","ubiquitous","ugandan","ukrainian","unanimous","unicameral","unified","unique","unisex","universal","urinal","urological","useful","useless","usurious","usurped","utilitarian","utopic","ubiquitously","unanimously","unicamerally","uniquely","universally","urologically","usefully","uselessly","usuriously"],i=["a","an"],t=/[aeiou8]/i,n=/[A-Z]+$/,u=/[UFHLMNRSX]/,a=/[.,\/#!$%\^&\*;:{}=\-_`~()]/g;function o(e){return"a"===e?"an":"a"}function s(r,t,n){var u;return State.length>0?(u="cannot add article override -> needs to be run in StoryInit special passage or earlier",console.error(u),u):t&&"string"==typeof t?(r&&"string"==typeof r&&(r=r.toLowerCase().trim()),i.includes(r)?(t=t.trim(),void(n?e.set(t,{article:r,caseSensitive:!!n}):e.set(t.toLowerCase(),{article:r,caseSensitive:!!n}))):(u='cannot add article override -> invalid article, must be "a" or "an"',console.error(u),u)):(u="cannot add article override -> invalid word",console.error(u),u)}function l(e){var i;return i=t.test(e.first())?"an":"a",function(e,i){return!!r.includes(e.toLowerCase())&&o(i)}(e,i)||function(e,r){return!(!n.test(e)||!u.test(e.first()))&&o(r)}(e,i)||i}function c(r){if(r&&"string"==typeof r){var i=r.trim().split(" ")[0].trim();return function(r){var i=(r=r.trim()).toLowerCase();if(e.has(i)||e.has(r)){var t=e.get(i)||e.get(r);return t.caseSensitive&&!e.has(r)?null:t.article}return null}(i=i.replace(a,""))||l(i)}}function h(e,r){if(!e||"string"!=typeof e)return e;var i=c(e);return(r?i.toUpperFirst():i)+" "+e}setup.articles={find:c,output:h,override:s},Macro.add("setarticle",{handler:function(){var e=s(this.args[0],this.args[1],this.args[2]);e&&"string"==typeof e&&this.error(e)}}),Macro.add(["a","an","A","An"],{handler:function(){var e=this.name.first()===this.name.first().toUpperCase();this.output.append(h(String(this.args[0]),e))}})}();
// end articles.min.js
// popover.min.js, for SugarCube 2, by Chapel
// v1.0.0, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;!function(){"use strict";function o(o,i){i=function(){return[].slice.call(arguments).flatten().filter((function(o){return o&&"string"==typeof o&&o.trim()}))||[]}(i),$("#ui-overlay, #ui-dialog").addClass("popover"),$("#ui-overlay, #ui-dialog, #ui-dialog-body").addClass(i),i.includesAny("noclick","no-click")&&$("#ui-overlay").removeClass("ui-close"),Dialog.setup("","popover"),Dialog.wiki(o),Dialog.open(),$(document).one(":dialogclosed",(function(){$("#ui-overlay").addClass("ui-close"),$("#ui-overlay, #ui-dialog").removeClass("popover"),$("#ui-overlay, #ui-dialog, #ui-dialog-body").removeClass(i)}))}Macro.add("popover",{tags:null,handler:function(){o(this.payload[0].contents,this.args)}}),Macro.add("dismisspopover",{skipArgs:!0,handler:function(){$("ui-overlay").hasClass("popover")&&Dialog.close()}}),setup.popover=o}();
// end popover.min.js
// pronouns.min.js, for SugarCube 2, by Chapel
// v1.1.0, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;!function(){"use strict";if(Template&&Template.add&&"function"==typeof Template.add){var e={name:"gender",showSetting:!0,label:"Gender",desc:"",storyVar:"%%gender",default:"female"},t="#setting-control-"+e.name,r={subjective:["she","he","they"],objective:["her","him","them"],possessive:["hers","his","theirs"],determiner:["her","his","their"],reflexive:["herself","himself","themself"],noun:["woman","man","person"]};e.showSetting&&(Setting.addToggle(e.name,{label:e.label,desc:e.desc&&"string"==typeof e.desc&&e.desc.trim()?e.desc.trim():void 0}),$(document).on(":dialogopen :dialogopened",(function(){$("#ui-dialog-body").hasClass("settings")&&$(t).parent("div").empty().append($(document.createElement("button")).append("Configure...").ariaClick((function(){h()})))})));var a=/^is$/i,n=/^was$/i,s=/^has$/i,i=/oes$/i,o=/^[dl]ies$/i,l=/ies$/i,u=/sses$/i,c=/hes$/i,d=/s$/i,p=/they/i;Template.add(["he","she","they","He","She","They"],(function(){return S(this.name,g().subjective)})),Template.add(["him","her","them","Him","Her","Them"],(function(){return S(this.name,g().objective)})),Template.add(["his","hers","theirs","His","Hers","Theirs"],(function(){return S(this.name,g().possessive)})),Template.add(["his_","her_","their","His_","Her_","Their"],(function(){return S(this.name,g().determiner)})),Template.add(["himself","herself","themself","Himself","Herself","Themself"],(function(){return S(this.name,g().reflexive)})),Template.add(["man","woman","person","Man","Woman","Person"],(function(){return S(this.name,g().noun)})),Template.add(["he-s","she-s","they-re","He-s","She-s","They-re"],(function(){return S(this.name,g().subjective+T("&apos;s","&apos;re",y()))})),Macro.add("pronouns",{skipArgs:!0,handler:function(){h()}}),Macro.add("verb",{handler:function(){var e=y();if(this.args.length<1)return this.error("Please pass at least a singular third person pronoun to this macro.");this.args.includes("plural")&&(e=!0),this.output.append(T(String(this.args[0]),this.args[1]?String(this.args[1]):null,!!e))}}),setup.gender={pronouns:g,setPronouns:function(t){return"string"==typeof t?v(t):"object"==typeof t?function(t){if("object"==typeof t)return State.variables[e.storyVar]=v("male"===e.default?1:0),Object.assign(State.variables[e.storyVar],t)}(t):void 0},dialog:h,pluralize:b},window.gender=window.gender||setup.gender}else alert("Warning, this version of SugarCube does not include the Template API. Please upgrade to v2.29.0 or higher.");function m(){var t=$(document.createElement("div"));var a=Object.keys(r).map((function(t){var a=2;"male"===e.default?a=1:"female"===e.default&&(a=0);var n=State.variables,s=r[t][a];return n[e.storyVar]&&n[e.storyVar][t]&&(s=n[e.storyVar][t]),function(e,t,r){return $(document.createElement("label")).append(e).css("display","block").append($(document.createElement("input")).attr({type:"text",name:t}).css({float:"right","margin-left":"0.2em"}).val(r))}(t.toUpperFirst()+": ","gender-"+t,s)})),n=function(e,t,r){var a=$(document.createElement("select")).attr("name",t).css("float","right");return r.forEach((function(e,t){console.log(t),$(document.createElement("option")).attr("value",String(t)).append(e).appendTo(a)})),$(document.createElement("label")).css("display","block").append(e,a)}("Presets: ","gender-preset",["She/Her","He/Him","They/Them"]).on("change",(function(){var e=Number($(this).find("select").val());Number.isNaN(e)||a.forEach((function(t){var a=t.find("input"),n=a.attr("name").split("-")[1];a.val(r[n][e])}))})),s=n.find("select");State.variables[e.storyVar]?s.val(""):"male"===e.default?s.val("1"):"female"===e.default?s.val("0"):s.val("2");var i,o=$(document.createElement("button")).wiki("Confirm").addClass("gender-confirm").ariaClick({label:"Confirm pronoun selection."},(function(){var t=State.variables;t[e.storyVar]={},a.forEach((function(r){var a=r.find("input"),n=a.attr("name").split("-")[1];t[e.storyVar][n]=a.val().trim().toLowerCase()})),$("#ui-dialog-body").hasClass("reopen")&&UI.settings(),Dialog.close()})),l=(i=[n,"<br>"],a.forEach((function(e){i.push(e),i.push("<br>")})),i.push(o),i);return t.append(l)}function h(){var e,t,r,a;e="Customize Gender",t=m(),r="custom-gender",a=!1,Dialog.isOpen()&&$("#ui-dialog-body").hasClass("settings")&&(a=!0),Dialog.close(),Dialog.setup(e,a?r+" reopen":r),Dialog.append(t),Dialog.open()}function f(e){("number"!=typeof e||Number.isNaN(e)||e>2||e<0)&&(e=0);var t={};return Object.keys(r).forEach((function(a){t[a]=r[a][e]})),t}function g(){return State.variables[e.storyVar]&&State.variables[e.storyVar].subjective?State.variables[e.storyVar]:f("male"===e.default?1:0)}function v(t){var r;switch(t){case"female":r=f(0);break;case"male":r=f(1);break;default:r=f(2)}return State.variables[e.storyVar]=clone(r),r}function b(e){return e&&"string"==typeof e?(e=e.trim(),a.test(e)?e.replace(a,"are"):n.test(e)?e.replace(n,"were"):s.test(e)?e.replace(s,"have"):i.test(e)?e.replace(i,"o"):o.test(e)?e.replace(l,"ie"):l.test(e)?e.replace(l,"y"):u.test(e)?e.replace(u,"ss"):c.test(e)?e.replace(c,"h"):d.test(e)?e.replace(d,""):e):e}function y(){return p.test(g().subjective.trim())}function T(e,t,r){return r?t&&"string"==typeof t?t:b(e):e}function S(e,t){return e.first()===e.first().toUpperCase()?t.toUpperFirst():t}}();
// end pronouns.min.js
// operations.min.js, for SugarCube 2, by Chapel
// v1.1.0, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;!function(){"use strict";var e=e||{},r=!0,t=!0,n=[0,100];function o(e,r){var t,n=[],o=0,i=1;if("string"==typeof e)n=e.split("d");else if("number"==typeof e&&r)n=[e,r];else{if(!(Array.isArray(e)&&e.length>=2))throw new TypeError("dice(): could not process arguments...");e.length=2,n=e}if(n[0]=Number(n[0]),"string"==typeof n[1]&&"F"===n[1].trim().toUpperCase()?(n[1]=3,i=-1):n[1]=Number(n[1]),n.some((function(e){return Number.isNaN(e)})))throw new TypeError("dice(): could not process arguments...");for(t=0;t<n[0];t++){o+=Math.floor(State.random()*n[1])+i}return o}function i(e,r){if("string"==typeof e){var t=[(n=e.trim().replace(/\s/g,"").match(/(\d+[d][\df]\d*)(.*)/i))[1],Number(n[2])];return o(t[0])+t[1]}return o(e,r);var n}e.dice={roll:i},r&&(window.dice=window.dice||i),Number.prototype.dice||Object.defineProperty(Number.prototype,"dice",{configurable:!0,writable:!0,value:function(e){if(0===this)return 0;if(this<0)throw new TypeError("Number.prototype.dice: cannot roll a negative number of dice!");if(("string"!=typeof e||"F"!==e.trim().toUpperCase())&&(null==e||"number"!=typeof e||e<=0||!Number.isInteger(e)))throw new TypeError("Number.prototype.dice: error in argument");if(!Number.isInteger(this))throw new TypeError("Number.prototype.dice: cannot roll partial dice!");return i(this,e)}}),Number.prototype.fairmath||Object.defineProperty(Number.prototype,"fairmath",{configurable:!0,writable:!0,value:function(e){var r=n;if(this<r[0]||this>r[1])throw new TypeError("Number.prototype.fairmath called on a number that is out of the defined range (the number was "+this+").");if(null==e||"number"!=typeof e||e>100||e<-100||arguments.length<1)throw new TypeError("Number.prototype.fairmath given incorrect argument or an argument that is out of the valid 0-100 range.");if(0===e)return Math.clamp(Math.trunc(this),r[0],r[1]);if(e<0)return e*=-1,Math.clamp(Math.trunc(this-(this-r[0])*(e/r[1])),r[0],r[1]);if(e>0)return Math.clamp(Math.trunc(this+(r[1]-this)*(e/r[1])),r[0],r[1]);throw new Error("Number.prototype.fairmath encountered an unspecified error.")}}),Number.prototype.between||Object.defineProperty(Number.prototype,"between",{configurable:!0,writable:!0,value:function(e,r){if("number"!=typeof e||"number"!=typeof r)throw new TypeError("Number.between() -> both values must be numbers");var t=Number(this);if(e===r)return t===e;if(r<e){var n=r;r=e,e=n}return t>=e&&t<=r}}),Math.fairmath||Object.defineProperty(Math,"fairmath",{configurable:!0,writable:!0,value:function(e,r){return e.fairmath(r)}}),Math.between||Object.defineProperty(Math,"between",{configurable:!0,writable:!0,value:function(e,r,t){return e.between(r,t)}}),t&&(Math.fm||Object.defineProperty(Math,"fm",{configurable:!0,writable:!0,value:function(e,r){return e.fairmath(r)}}),Number.prototype.fm||Object.defineProperty(Number.prototype,"fm",{configurable:!0,writable:!0,value:function(e){return this.fairmath(e)}}),Number.prototype.d||Object.defineProperty(Number.prototype,"d",{configurable:!0,writable:!0,value:function(e){return this.dice(e)}}))}();
// end operations.min.js
// speech.min.js, for SugarCube 2, by Chapel
// v1.1.1, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;!function(){"use strict";var a=new Map;function t(t,e,r){if(void 0===r&&e&&(r=e,e=null),State.length)throw new Error("addCharacter() -> must be called before story starts");t&&r?(a.has(t)&&console.error('addCharacter() -> overwriting character "'+t+'"'),a.set(t,{displayName:e,image:r})):console.error("addCharacter() -> invalid arguments")}function e(t,e,r,s){var n=$(document.createElement("div")).addClass(Util.slugify(e)+" say"),i=a.has(e)?a.get(e).image:null,o=$(document.createElement("img")).attr("src",s||i||"");o.attr("src")&&o.attr("src").trim()&&n.append(o);var c=e.toUpperFirst();return a.has(e)&&a.get(e).displayName&&(c=a.get(e).displayName),n.append($(document.createElement("p")).wiki(c)).append($(document.createElement("p")).wiki(r)),t&&(t instanceof $||(t=$(t)),n.appendTo(t)),n}setup.say=e,setup.addCharacter=t,Macro.add("character",{handler:function(){t(this.args[0],this.args[1],this.args[2])}}),$(document).one(":passagestart",(function(){var t=Array.from(a.keys());t.push("say"),Macro.add(t,{tags:null,handler:function(){"say"!==this.name?e(this.output,this.name,this.payload[0].contents):e(this.output,this.args[0],this.payload[0].contents,this.args[1])}})}))}();
// end speech.min.js
// type-sim.min.js, for SugarCube 2, by Chapel
// v2.0.0, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;!function(){"use strict";Macro.add("typesim",{tags:null,handler:function(){if(!this.args.length||!this.args[0]||"string"!=typeof this.args[0])return this.error("no text to type out was provided");var t,e=$(document.createElement("span")).addClass("macro"+this.name),n=$(document.createElement("div"));this.payload[0].contents&&this.payload[0].contents.trim()&&(t=this.payload[0].contents),function(t,e,n){if(t&&"string"==typeof t){!e||e instanceof $||(e=$(e));var i=0,s=t.split(""),a=[],o=$(document.createElement("textarea")).addClass("type-sim").on("input.type-sim",(function(){var e=$(this);i=a.push(s[i]),e.val(a.join("")),t.length===a.length&&(e.off("input.type-sim").ariaDisabled(!0),n&&"function"==typeof n&&n(a.join("")),$(document).trigger({type:":type-sim-end",message:a.join("")}))}));e&&e[0]&&e.append(o)}}(this.args[0],e,(function(){n.wiki(t)})),e.append(n).appendTo($(this.output))}})}();
// end type-sim.min.js
// cycles.min.js, for SugarCube 2, by Chapel
// v2.1.1, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;!function(){"use strict";var e="%%cycles",t=!0,r="cycles.pause",i="cycles.pause.menu",s="cycles.postdisplay";function n(){return State.variables[e]}function a(e,t){if(!(this instanceof a))return new a(e,t);if(!e||"object"!=typeof e)throw new Error("Cycle() -> invalid definition object");if(!e.name||"string"!=typeof e.name||!e.name.trim())throw new Error("Cycle() -> invalid name");if(this.name=e.name,!e.phases||!Array.isArray(e.phases)||e.phases.length<2)throw new Error("Cycle() -> phases should be an array of at least two strings");if(!e.phases.every((function(e){return e&&"string"==typeof e&&e.trim()})))throw new Error("Cycle() -> each phase should be a valid, non-empty string");this.phases=clone(e.phases),e.period=Number(e.period),(Number.isNaN(e.period)||e.period<1)&&(e.period=1),Number.isInteger(e.period)||(e.period=Math.trunc(e.period)),this.period=e.period,e.increment=Number(e.increment),(Number.isNaN(e.increment)||e.increment<1)&&(e.increment=1),Number.isInteger(e.increment)||(e.increment=Math.trunc(e.increment)),this.increment=e.increment,this.active=void 0===e.active||!!e.active,t=Number(t),(Number.isNaN(t)||t<0)&&(t=0),Number.isInteger(t)||(t=Math.trunc(t)),this.stack=t}State.variables[e]={},Object.assign(a,{is:function(e){return e instanceof a},add:function(e,t){if(!t||"object"!=typeof t)throw new Error("Cycle.add() -> invalid definition object");if(e&&"string"==typeof e&&e.trim())t.name=e;else if(!t.name||"string"!=typeof t.name||!t.name.trim())throw new Error("Cycle.add() -> invalid name");var r=new a(t,0);return n()[t.name]=r,r},has:function(e){var t=n();return t.hasOwnProperty(e)&&a.is(t[e])},get:function(e){return a.has(e)?n()[e]:null},del:function(e){return!!a.has(e)&&(delete n()[e],!0)},check:function(e){if(a.has(e)){var t=[].slice.call(arguments).flatten().slice(1);return a.get(e).check(t)}},clear:function(e){n()},_emit:function(e,t){$(document).trigger({type:":cycle-"+t,cycle:e})},_retrieveCycles:n}),Object.assign(a.prototype,{constructor:a,revive:function(){var e={};return Object.keys(this).forEach((function(t){e[t]=clone(this[t])}),this),e},clone:function(){return new a(this.revive(),this.stack)},toJSON:function(){return JSON.reviveWrapper("new setup.Cycle("+JSON.stringify(this.revive())+", "+this.stack+")")},current:function(){return this.phases[Math.trunc(this.stack/this.period)%this.phases.length]},length:function(){return this.period*this.phases.length},turns:function(){return this.period/this.increment},turnsTotal:function(){return this.length()/this.increment},update:function(e){e=Number(e),Number.isNaN(e)&&(e=this.increment);var t=this.current();return this.stack+=e,this.stack<0&&(this.stack=0),Number.isInteger(this.stack)||(this.stack=Math.trunc(this.stack)),t!==this.current()&&a._emit(this,"change"),this},reset:function(){return this.stack=0,a._emit(this,"reset"),this.update(0)},suspend:function(){var e=this.active;return this.active=!1,e!==this.active&&a._emit(this,"suspend"),this},resume:function(){var e=this.active;return this.active=!0,e!==this.active&&a._emit(this,"resume"),this},toggle:function(){return this.active?this.suspend():this.resume(),this},isSuspended:function(){return!this.active},editIncrement:function(e){return e=Number(e),(!Number.isNaN(e)||e>0)&&(Number.isInteger(e)||(e=Math.trunc(e)),this.increment=e),this.increment},check:function(){var e=[].slice.call(arguments).flatten();return e.includes(this.current())}}),postdisplay[s]=function(){var e;tags().includes(r)||e?e=!1:tags().includes(i)?e=!0:Object.keys(n()).forEach((function(e){var t=a.get(e);t.active&&t.update()}))},setup.Cycle=a,t&&(window.Cycle=window.Cycle||a),Macro.add("newcycle",{tags:["phase"],handler:function(){if(this.args.length<1)return this.error("A cycle must at least be given a name.");if(this.payload.length<2)return this.error("A cycle must be given at least two phases.");var e=this.payload.slice(1).map((function(e){return function(e){if(e.args.length<1)return null;var t=e.args.flatten();return t.every((function(e){return"string"==typeof e}))?t:null}(e)})).flatten();if(e.includes(null))return this.error("Each `<<phase>>` tag must be given a valid name.");try{a.add(this.args[0],{phases:e,period:this.args[1],increment:this.args[2],active:this.args[3]&&"string"==typeof this.args[3]&&"suspend"!==this.args[3].trim()})}catch(e){var t=e.message&&e.message.split("->")[1];return t=!!t&&t.trim(),this.error(t||e.message)}}}),Macro.add("editcycle",{handler:function(){if(this.args.length<1||"string"!=typeof this.args[0]||!this.args[0].trim())return this.error("You must name the cycle you wish to act on.");if(this.args.length<2)return this.error("You must provide an action to perform.");var e=a.get(this.args[0]);if(null===e)return this.error('Cannot find a cycle named "'+this.args[0]+'".');if(this.args.includes("suspend")?e.suspend():this.args.includes("toggle")?e.toggle():this.args.includes("resume")&&e.resume(),this.args.includes("increment")){var t=this.args[this.args.indexOf("increment")+1];"number"==typeof t&&e.editIncrement(t)}if(this.args.includesAny("reset","clear")&&e.reset(),this.args.includes("change")){var r=this.args[this.args.indexOf("change")+1];r=Number(r),!Number.isNaN(r)&&Number.isInteger(r)&&e.update(r)}}}),Macro.add("showcycle",{handler:function(){if(this.args.length<1||"string"!=typeof this.args[0]||!this.args[0].trim())return this.error("You must name the cycle you wish to act on.");var e=a.get(this.args[0]);if(null===e)return this.error('Cannot find a cycle named "'+this.args[0]+'".');var t=e.current();this.args.includes("uppercase")?t=t.toUpperCase():this.args.includes("lowercase")?t=t.toLowerCase():this.args.includes("upperfirst")&&(t=t.toUpperFirst()),$(document.createElement("span")).addClass("macro-"+this.name).append(t).appendTo(this.output)}})}();
// end cycles.min.js
// playtime.min.js, for SugarCube 2, by Chapel
// v2.1.0, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;!function(){"use strict";var e=!0,t="playtime",a="pausetimer";function n(){return Date.now()-State.variables[t]}function r(e){if(e&&!(e<0)&&"number"==typeof e){var t=[];return t.push(Math.floor(e/1e3)%60),t.push(Math.floor(e/6e4)%60),t.push(Math.floor(e/36e5)),t}}State.variables[t]=Date.now(),predisplay["start-playtime"]=function(e){delete predisplay[e],State.variables[t]||(State.variables[t]=Date.now())},prehistory["pause-playtime"]=function(e){tags().includes(a)&&(State.variables[t]+=time())};var i=["h","hr","hrs","hour","hours"],s=["m","min","mins","minute","minutes"],u=["s","sec","secs","second","seconds"];function o(e){return function(e,t){if(e&&Array.isArray(e)&&!(e.length<3)){var a=e[2]<10?"0"+e[2]:""+e[2],n=e[1]<10?"0"+e[1]:""+e[1],r=e[0]<10?"0"+e[0]:""+e[0];return t?"<b>"+a+":"+n+"</b>:"+r:a+":"+n+":"+r}}(r(n()),e)}setup.playTime=function(e){return"string"==typeof e?function(e){var t=n(),a=r(t);return i.includes(e)?a[2]:s.includes(e)?a[1]:u.includes(e)?a[0]:t}(e):o(e)},e&&(window.playTime=window.playTime||setup.playTime),Macro.add("playtime",{handler:function(){var e=this.args.map((function(e){return String(e).trim().toLowerCase()})),t=$(document.createElement("span")),a=o(e.includesAny(["format","f","fmt","b","bold","true"]));t.wiki(a).addClass("macro-"+this.name).appendTo(this.output)}})}();
// end playtime.min.js
// meters.min.js, for SugarCube 2, by Chapel
// v1.0.1, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;!function(){"use strict";var t=!0,e=!1,s=!1,i={full:"#2ECC40",empty:"#FF4136",back:"#DDDDDD",height:"12px",width:"180px",animate:400,easing:"swing",text:"#111111",label:"",align:"center"},n=["center","left","right"],r=["swing","linear"];function a(t,e){return t&&"string"==typeof t&&(t=t.toLowerCase().trim())?t:e||""}function o(t){return t<.5?2*t*t:(4-2*t)*t-1}function l(t,e){if(!(this instanceof l))return new l(t,e);var s=clone(i);this.settings=Object.assign(s,t),this.settings.align=a(this.settings.align),this.settings.easing=a(this.settings.easing),n.includes(this.settings.align)||(this.settings.align="center"),r.includes(this.settings.easing)||(this.settings.easing="swing"),e=Number(e),Number.isNaN(e)&&(e=1),e=Math.clamp(e,0,1),this.value=e;var h=$(document.createElement("div")).addClass("chapel-meter").attr({"data-val":e,"data-label":this.settings.label}).css({position:"relative","background-color":this.settings.back,height:this.settings.height,width:this.settings.width,overflow:"hidden"}),g=$(document.createElement("div")).addClass("meter-label").css({top:0,right:0,"font-size":this.settings.height,"font-weight":"bold","line-height":"100%",width:"100%",height:"100%","vertical-align":"middle","text-align":this.settings.align,color:this.settings.text,"z-index":1,position:"relative",bottom:"100%"}).wiki(this.settings.label).appendTo(h),u=$(document.createElement("div")).addClass("meter-top").css({"background-color":this.settings.full,opacity:o(this.value),width:"100%",height:"100%","z-index":0}),c=$(document.createElement("div")).addClass("meter-bottom").css({position:"absolute",top:0,left:0,"background-color":this.settings.empty,opacity:1,width:100*this.value+"%",height:"100%","z-index":0}).append(u).appendTo(h);this.$element=h,this.$bars={top:u,bottom:c},this.$label=g,g.css("font-size",parseInt(h.css("height"),10)<parseInt($(".passage").css("font-size"),10)?h.css("height"):$(".passage").css("font-size")),g.css("line-height",h.css("height"))}Object.assign(l,{_list:new Map,is:function(t){return t instanceof l},has:function(t){return l._list.has(t)&&l.is(l._list.get(t))},get:function(t){return l.has(t)?l._list.get(t):null},del:function(t){l.has(t)&&l._list.delete(t)},add:function(t,s,i){if(!l.has(t)||e){Object.assign(s,{id:t});var n=new l(s,i);return l._list.set(t,n),n}console.error('Meter "'+t+'" already exists.')},_emit:function(t,e){l.is(t)&&t.$element.trigger({type:":"+e,meter:t})}}),Object.assign(l.prototype,{constructor:l,_label:function(t){var e=this;function s(){e.$label.empty().wiki(e.settings.label),e.$label.css("font-size",parseInt(e.$element.css("height"),10)<parseInt(e.$element.parent().css("font-size"),10)?e.$element.css("height"):e.$element.parent().css("font-size")),e.$label.css("line-height",e.$element.css("height"))}return t?setTimeout(s,Engine.minDomActionDelay):s(),this},_width:function(){var t=this;return this.$bars.bottom.animate({width:100*this.value+"%"},this.settings.animate,this.settings.easing,(function(){l._emit(t,"meter-animation-complete")})),this},_color:function(){return this.$bars.top.animate({opacity:o(this.value)},this.settings.animate,this.settings.easing),this},animate:function(){return l._emit(this,"meter-animation-start"),this._color()._width()._label()},val:function(t){return void 0!==t&&(t=Number(t),Number.isNaN(t)&&(t=1),t=Math.clamp(t,0,1),this.value=t,this.animate()),this.value},options:function(t){return t&&"object"==typeof t&&Object.assign(this.settings,t),this.settings},unwrap:function(){return this.$element[0]},place:function(t,e){var s=$(document.createElement("span"));return t instanceof jQuery||(t=$(t)),t[0]||console.warn("meter#place() -> no valid target"),e&&"object"==typeof e&&(e.classes&&(Array.isArray(e.classes)||"string"==typeof e.classes)&&s.addClass(e.classes),e.attr&&"object"==typeof e.attr&&s.attr(e.attr)),t.append(s.append(this.$element)),this._label(!0),this},on:function(t,e){return"function"!=typeof e?this:t&&"string"==typeof t&&t.trim()?(t=t.split(" ").map((function(t){return(t=t.split(".")[0])+".userland"})).join(" "),this.$element.on(t,e),this):this},one:function(t,e){return"function"!=typeof e?this:t&&"string"==typeof t&&t.trim()?(t=t.split(" ").map((function(t){return(t=t.split(".")[0])+".userland"})).join(" "),this.$element.one(t,e),this):this},off:function(t){return t=t&&"string"==typeof t&&t.trim()?t.split(" ").map((function(t){return(t=t.split(".")[0])+".userland"})).join(" "):".userland",this.$element.off(t),this},click:function(t,e){return this.$element.ariaClick(t,e),this},clone:function(){return new l(this.settings,this.value)},toJSON:function(){return JSON.reviveWrapper("new setup.Meter("+JSON.stringify(this.settings)+", "+this.value+")")}}),setup.Meter=l,t&&(window.Meter=window.Meter||l),Macro.add("newmeter",{tags:["colors","sizing","animation","label"],handler:function(){if(State.length>0&&!s)return this.error("The `<<newmeter>>` macro must be called in your `StoryInit` special passage. Seriously. No excuses. --Love, Chapel");if(this.args.length<1)return this.error("The `<<newmeter>>` macro requires at least one argument: a meter name.");var t=this.args[0],i=null,n=null,r=null,a=null;if("string"!=typeof t)return this.error("Invalid meter name.");if(t=t.trim(),l.has(t)&&!e)return this.error('Cannot clobber the existing meter "'+t+'".');this.payload.length&&(i=this.payload.find((function(t){return"colors"===t.name})),n=this.payload.find((function(t){return"sizing"===t.name})),r=this.payload.find((function(t){return"animation"===t.name})),a=this.payload.find((function(t){return"label"===t.name})));var o={};if(i){if(!i.args.length)return this.error("No arguments passed to the `<<colors>>` tag.");switch(i.args.length){case 1:o.empty=i.args[0],o.full="transparent";break;case 2:o.full=i.args[0],o.empty=i.args[1];break;default:o.full=i.args[0],o.empty=i.args[1],o.back=i.args[2]}}if(n){if(!n.args.length)return this.error("No arguments passed to the `<<sizing>>` tag.");o.width=n.args[0],n.args[1]&&(o.height=n.args[1])}if(r){if(!r.args.length)return this.error("No arguments passed to the `<<animation>>` tag.");if("boolean"!=typeof r.args[0]||r.args[0]){if("string"!=typeof r.args[0])return this.error("The argument to the `<<animation>>` tag should be `true`, `false`, or a valid CSS time value.");o.animate=Util.fromCssTime(r.args[0])}else o.animate=0;r.args[1]&&["swing","linear"].includes(r.args[1])&&(o.easing=r.args[1])}if(a){var h=a.args[0];if(!h||"string"!=typeof h)return this.error("The labelText argument for the `<<label>>` tag is required.");o.label=h.trim(),a.args[1]&&"string"==typeof a.args[1]&&(o.text=a.args[1]),a.args[2]&&"string"==typeof a.args[2]&&(o.align=a.args[2])}l.add(t,o,this.args[1])}}),Macro.add("showmeter",{handler:function(){if(this.args.length<1)return this.error("This macro requires at least one argument: the meter's name.");var t=this.args[0];if("string"!=typeof t)return this.error("Invalid meter name.");t=t.trim();var e=l.get(t);if(!e||!l.is(e))return this.error('The meter "'+t+'" does not exist.');"number"==typeof this.args[1]&&e.val(this.args[1]),e.place(this.output,{classes:"macro-"+this.name,attr:{id:"meter-"+Util.slugify(t)}})}}),Macro.add("updatemeter",{handler:function(){if(this.args.length<2)return this.error("This macro requires two arguments: the meter's name and a value.");var t=this.args[0];if("string"!=typeof t)return this.error("Invalid meter name.");t=t.trim();var e=l.get(t);if(!e||!l.is(e))return this.error('The meter "'+t+'" does not exist.');e.val(this.args[1])}})}();
// end meters.min.js
// disable.min.js, for SugarCube 2, by Chapel
// v1.0.0, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;!function(){"use strict";var a=["button","fieldset","input","menuitem","optgroup","option","select","textarea"];Macro.add("disable",{tags:null,handler:function(){var t,i,e,s=$(document.createElement("span")).addClass("macro-"+this.name).wiki(this.payload[0].contents);try{t=this.args.raw.trim()?!!Scripting.evalJavaScript(this.args.full):void 0}catch(a){return this.error("bad evaluation: "+a.message)}!function(a,t){a instanceof $||(a=$(a)),a.ariaDisabled(void 0===t||!!t),function(a){a.ariaIsDisabled()?a.addClass("disabled"):a.removeClass("disabled")}(a)}((i=s,e=$(i).find(a.join(",")).first(),e[0]||(e=$(i).children().eq(0))[0]?e:$(i)),t),$(this.output).append(s)}})}();
// end disable.min.js
// notify.min.js, for SugarCube 2, by Chapel
// v1.1.1, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;!function(){var s=/\d+m?s$/;function e(s,e,t){"string"==typeof s&&("number"!=typeof e&&(e=!1),$(document).trigger({type:":notify",message:s,delay:e,class:t||""}))}$(document.body).append("<div id='notify'></div>"),$(document).on(":notify",(function(s){s.message&&"string"==typeof s.message&&(s.message.trim(),s.class?"string"==typeof s.class?s.class="open macro-notify "+s.class:Array.isArray(s.class)?s.class="open macro-notify "+s.class.join(" "):s.class="open macro-notify":s.class="open macro-notify",s.delay?("number"!=typeof s.delay&&(s.delay=Number(s.delay)),Number.isNaN(s.delay)&&(s.delay=2e3)):s.delay=2e3,$("#notify").empty().wiki(s.message).addClass(s.class),setTimeout((function(){$("#notify").removeClass()}),s.delay))})),Macro.add("notify",{tags:null,handler:function(){var t=this.payload[0].contents,a=!1,n=!1;if(this.args.length>0){var i=s.test(this.args[0]);"number"==typeof this.args[0]||i?(a=i?Util.fromCssTime(this.args[0]):this.args[0],n=this.args.length>1&&this.args.slice(1).flatten()):n=this.args.flatten().join(" ")}e(t,a,n)}}),setup.notify=e}();
// end notify.min.js
// events.min.js, for SugarCube 2, by Chapel
// v2.0.0, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;setup.eventMacroNamespace="macro-event",Macro.add("trigger",{handler:function(){var t;return this.args.length>2||0===this.args.length?this.error("incorrect number of arguments"):"string"!=typeof this.args[0]?this.error("first argument should be a string and a valid event type"):(t=this.args[0],void(1===this.args.length||this.args[1]&&"string"==typeof this.args[1]&&"document"===this.args[1].toLowerCase().trim()?$(document):$(this.args[1])).trigger(t))}}),Macro.add(["event","on","one"],{tags:["which"],handler:function(){var t,r,e=this.payload,s="on",n="",a="";return this.args.length>3||0===this.args.length?this.error("incorrect number of arguments"):"string"!=typeof this.args[0]?this.error("first argument should be a string and a valid event type"):(2===this.args.length&&"string"==typeof this.args[1]&&"once"!==this.args[1]&&(n=this.args[1]),(this.args.includes("once")||"one"===this.name)&&(s="one"),t=this.args[0],void $(document)[s](t+"."+setup.eventMacroNamespace,n,this.createShadowWrapper((function(t){if(0===$("input:focus").length){if(a=e[0].contents,e.length>1)for(r=1;r<e.length;r++)e[r].args.includes(t.which)&&(a+=e[r].contents);new Wikifier(null,a)}}))))}}),Macro.add("off",{handler:function(){var t;return this.args.length>2||0===this.args.length?this.error("incorrect number of arguments"):"string"!=typeof this.args[0]?this.error("first argument should be a string and a valid event type or namespace"):(t=this.args[0],void(1===this.args.length||this.args[1]&&"string"==typeof this.args[1]&&"document"===this.args[1].toLowerCase().trim()?$(document):$(this.args[1])).off(t))}});
// end events.min.js
// first-macro.min.js, for SugarCube 2, by Chapel
// v1.1.1, 2024-02-20, 1d7a524b6004aa67a99f9037e0c3bf2b537193d5
;Macro.add("first",{skipArgs:!0,tags:["then","finally"],handler:function(){var a,t=$(document.createElement("span")),n=this.payload[this.payload.length-1],s=visited()-1;a=s<this.payload.length?this.payload[s].contents:"finally"===n.name?n.contents:"",t.wiki(a).addClass("macro-"+this.name).appendTo(this.output)}});
// end first-macro.min.js

Macro.add('dyslexia', {
	tags: null,
	handler  : function () {
		// Dyslexia by SjoerdHekking
		'use strict';

		let out = $(`<span class="macro-mess-up-words" />`)
        	.wiki(this.payload[0].contents)
          	.appendTo(this.output);

		// returns texts
		let getTextNodesIn = function(el) {
		    return $(el).find(":not(iframe,script)").addBack().contents().filter(function() {
		        return this.nodeType === 3;
		    });
		};

		// only allow scanning within these tags
		let textNodes = getTextNodesIn(out);

		let errorArray = [];

		let storeArg = this.args[0] || 10;
		let storeArg2 = this.args[1] || 3;
		let storeArg3 = this.args[2] || 50;

		if (storeArg) {
			storeArg = parseInt(storeArg);
			if (isNaN(storeArg) || storeArg < 0 || storeArg > 100) {
				errorArray.push("Check first argument. Invalid value.");
			}
		} 
		if (storeArg2) {
			storeArg2 = parseInt(storeArg2);
			if (isNaN(storeArg2) || storeArg2 < 2) {
				errorArray.push("Check second argument. Invalid value.");
			}
		} 
		if (storeArg3) {
			storeArg3 = parseInt(storeArg3);
			if (isNaN(storeArg3) || storeArg3 < 50) {
				errorArray.push("Check third argument. Invalid value.");
			}
		} 

		if (errorArray.length > 0) {
			let joinedArray = errorArray.join('\n')
			return this.error(joinedArray);
		}

		let wordsInTextNodes = [];
		for (let i = 0; i < textNodes.length; i++) {
			const node = textNodes[i];
			const wordsInNode = node.nodeValue.match(/\w+/g) || [];
		
			wordsInTextNodes[i] = wordsInNode.map((word, index) => ({
				length: word.length,
				position: node.nodeValue.indexOf(word, index === 0 ? 0 : wordsInNode[index - 1].length + wordsInNode[index - 1].index)
			}));
		}

		/**
		 * Messes up the words in text nodes according to the probability and word length delay set in the dyslexia macro.
		 */
		function messUpWords () {
			for (let i = 0; i < textNodes.length; i++) {
				let node = textNodes[i];

				for (let j = 0; j < wordsInTextNodes[i].length; j++) {
					
					if (Math.random() < (100 - storeArg) / 100 ) {
						continue;
					}

					let wordMeta = wordsInTextNodes[i][j];
					let word = node.nodeValue.slice(wordMeta.position, wordMeta.position + wordMeta.length);
					node.nodeValue = node.nodeValue.slice(0, wordMeta.position) + messUpWord(word) + node.nodeValue.slice(wordMeta.position + wordMeta.length);
				};
			};
		}

		/**
		 * Messes up a single word by swapping random letters in the "messy part" of the word (i.e. all letters except the first and last).
		 * @param {string} word - The word to mess up.
		 * @returns {string} The messed up word, or the original word if its length is less than the minimum word length specified in the dyslexia macro.
		 */
		function messUpWord (word) {
			if (word.length < storeArg2) return word;
			const middle = messUpMessyPart(word.slice(1, -1));
  			return `${word[0]}${middle}${word.slice(-1)}`;
		}

		/**
		 * Messes up the "messy part" of a word by swapping two random letters.
		 * @param {string} messyPart - The "messy part" of a word to mess up.
		 * @returns {string} The messed up "messy part", or the original "messy part" if its length is less than 2.
		 */
		function messUpMessyPart (messyPart) {
			if (messyPart.length < 2) return messyPart;

			let a, b;
			while (!(a < b)) {
				a = getRandomInt(0, messyPart.length - 1);
				b = getRandomInt(0, messyPart.length - 1);
			}

			function getRandomInt(min, max) {
				return Math.floor(Math.random() * (max - min + 1) + min);
			}

			return `${messyPart.slice(0, a)}${messyPart[b]}${messyPart.slice(a+1, b)}${messyPart[a]}${messyPart.slice(b+1)}`;
		}

		setInterval(messUpWords, storeArg3);
	}
});

// Simple Inventory, for SugarCube 2, by Chapel
// v3.0.0, 2024-02-20, 1d95a49488446cafefaa956e53345395394e4b51
;"use strict";function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,_toPropertyKey(i.key),i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:String(e)}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}!function(){var t={description:"",handler:null,displayName:"",consumable:!0,unique:!1,permanent:!1},e=new Map,n=function(){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:clone(t),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(_classCallCheck(this,n),!e||"string"!=typeof e)throw new Error("invalid item ID");if("object"!==_typeof(i))throw new Error("invalid item definition");Object.assign(this,Object.assign(t,i)),this.id=e,this._tags=r instanceof Array?r:"string"==typeof r?[r]:[]}return _createClass(n,[{key:"tags",get:function(){return this._tags}},{key:"hasTag",value:function(t){return this._tags.includes(t)}},{key:"hasAllTags",value:function(){return this._tags.includesAll([].slice.call(arguments).flat(1/0))}},{key:"hasAnyTags",value:function(){return this._tags.includesAny([].slice.call(arguments).flat(1/0))}},{key:"name",get:function(){return this.displayName||this.id},set:function(t){this.displayName=t}},{key:"use",value:function(){return"string"==typeof this.handler?$.wiki(this.handler):"function"==typeof this.handler&&this.handler(this),this}},{key:"inspect",value:function(){return Dialog.setup(this.name,"simple-inventory item-description"),Dialog.wiki(this.description),Dialog.open(),this}}],[{key:"is",value:function(t){return t instanceof n}},{key:"add",value:function(t,i,r){var a=new n(t,i,r);return e.set(t,a),a}},{key:"get",value:function(t){return e.get(t)}},{key:"has",value:function(t){return e.has(t)}},{key:"list",get:function(){return e}}]),n}();setup.Item=n,window.Item=window.Item||n}(),function(){var t=setup.Item,e=!1,n="&hellip;",i={inspect:"Inspect",use:"Use",drop:"Drop",stack:"stack",take:"Take",give:"Give",stackPre:"&nbsp;&times;&nbsp;",stackPost:"&nbsp;"},r={};function a(e){return t.has(e)&&t.get(e).unique}var s=function(){function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];_classCallCheck(this,s),this.data=clone(t),this._tags=e instanceof Array?e:"string"==typeof e?[e]:[]}return _createClass(s,[{key:"emit",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s.emit(t,this,e),this}},{key:"array",get:function(){var t=this,e=[];return Object.keys(this.data).forEach((function(n){if(e.push(n),t.data[n]>1)for(var i=1;i<t.data[n];i++)e.push(n)})),e}},{key:"list",get:function(){return Object.keys(this.data)}},{key:"length",get:function(){return this.array.length}},{key:"uniqueLength",get:function(){return this.list.length}},{key:"table",get:function(){return this.data}},{key:"tags",get:function(){return this._tags}},{key:"hasTag",value:function(t){return this._tags.includes(t)}},{key:"hasAllTags",value:function(){return this._tags.includesAll([].slice.call(arguments).flat(1/0))}},{key:"hasAnyTags",value:function(){return this._tags.includesAny([].slice.call(arguments).flat(1/0))}},{key:"count",value:function(t){return t?this.data[t]||0:this.length}},{key:"has",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.data[t]>=e}},{key:"hasAll",value:function(){var t=this;return[].slice.call(arguments).flat(1/0).every((function(e){return t.has(e)}))}},{key:"hasAny",value:function(){var t=this;return[].slice.call(arguments).flat(1/0).some((function(e){return t.has(e)}))}},{key:"compare",value:function(t){var e=this,n=s.itemset(t);return Object.keys(n).every((function(t){return e.has(t,n[t])}))}},{key:"merge",value:function(t){var e=this,n=s.itemset(t);return Object.keys(n).forEach((function(t){s.change(e,t,n[t])})),n}},{key:"unmerge",value:function(t){var e=this,n={},i=s.itemset(t);return Object.keys(i).forEach((function(t){e.has(t,i[t])?n[t]=i[t]:e.has(t)&&(n[t]=e.count(t)),s.change(e,t,i[t],!0)})),n}},{key:"pickup",value:function(){var t=this.merge(s.parseArgList.apply(null,arguments));return this.emit("update",{delta:t}),this}},{key:"drop",value:function(){var t=this.unmerge(s.parseArgList.apply(null,arguments));return this.emit("update",{delta:t}),this}},{key:"empty",value:function(){var t=clone(this.data);return this.data={},this.emit("update",{delta:t}),this}},{key:"transfer",value:function(t){var e=s.parseArgList.apply(null,[].slice.call(arguments).slice(1));if(!s.is(t))throw new TypeError("target inventory is not an inventory instance");var n=this.unmerge(e);return t.merge(n),this.emit("update",{target:t,delta:n}),this}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"iterate",value:function(t){var e=this;return"function"!=typeof t||this.list.forEach((function(n){t(n,e.data[n])})),this}},{key:"use",value:function(e){if(t.has(e)){var n=t.get(e);if(n.use(),n.consumable){s.change(this,e,1,!0);var i={};i[e]=1,this.emit("update",{delta:i})}return this.emit("use",{item:n}),this}}},{key:"clone",value:function(){return new s(this.data||{},this._tags||[])}},{key:"toJSON",value:function(){return JSON.reviveWrapper("new setup.Inventory("+JSON.stringify(this.data)+", "+JSON.stringify(this._tags)+")")}}],[{key:"confirm",get:function(){return e},set:function(t){e="string"==typeof t&&"all"===t.trim().toLowerCase()?"all":"string"==typeof t&&"stack"===t.trim().toLowerCase()?"stack":!!t}},{key:"emptyMessage",get:function(){return n},set:function(t){"string"==typeof t&&(n=t)}},{key:"strings",get:function(){return Object.assign(clone(i),r)},set:function(t){"object"===_typeof(t)&&(r=Object.assign(r,clone(t)))}},{key:"change",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(0!==i){if(e instanceof s&&(e=e.data),"object"!==_typeof(e)){if(e)throw new TypeError("cannot access inventory data");e={}}if(!(o=n)||"string"!=typeof o||!o.trim())throw new TypeError("invalid item name/id");var o;if("number"==typeof i&&!Number.isNaN(i)&&Number.isInteger(i)||(i=1),r&&(i*=-1),i>0){if(Object.keys(e).includes(n)&&a(n))return;i>1&&a(n)&&(i=1),Object.keys(e).includes(n)||(e[n]=0),e[n]+=i}else{if(function(e){return t.has(e)&&t.get(e).permanent}(n))return;Object.keys(e).includes(n)&&"number"==typeof e[n]&&(e[n]+=i),e[n]<=0&&delete e[n]}return e}}},{key:"itemset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(s.is(t)&&(t=t.data),"object"!==_typeof(t))return{};var e={};return Object.keys(t).forEach((function(n){"number"==typeof t[n]&&Number.isInteger(t[n])&&0!==t[n]&&(e[n]=t[n])})),e}},{key:"parseArgList",value:function(){var t=[].slice.call(arguments).flat(1/0);if(t.length%2!=0)throw new Error("item sets should be pairs of item IDs and numbers");var e={};return t.forEach((function(n,i){i%2==0&&(e[n]=t[i+1])})),e}},{key:"is",value:function(t){return t instanceof s}},{key:"emit",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};$(document).trigger(Object.assign({type:":inventory-"+t+".simple-inventory",inventory:e,target:null,delta:{},item:null},n))}},{key:"create",value:function(t,e){return new s(t,e)}}]),s}();setup.Inventory=s,window.Inventory=window.Inventory||s}(),function(){var t=setup.Item,e=setup.Inventory;function n(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Alert",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"Are you sure?";if(!t||"function"!=typeof t)throw new Error("Invalid confirmation callback!");if(e.confirm)if("all"!==e.confirm||"all"===i)if("stack"!==e.confirm||i){var s={display:"inline-block",float:"right"},o=$(document.createElement("div")),u=$(document.createElement("p")).append(a),l=$(document.createElement("div")).addClass("confirmation-buttons"),c=$(document.createElement("button")).append("Okay").addClass("confirm-yes").css(Object.assign(s,{"margin-right":"0.5rem"})),d=$(document.createElement("button")).append("Cancel").addClass("confirm-no").css(s);t&&"function"==typeof t&&c.ariaClick(t),n&&"function"==typeof n&&d.ariaClick(n),l.append(d,c),o.append(u,l),Dialog.setup(r,"simple-inventory confirmation"),Dialog.append(o),Dialog.open()}else t();else t();else t()}function i(t){var e=$(document.createElement("span")).addClass("spacer");return t&&e.wiki(""+t),e}function r(t,i){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return"give"===String(i).toLowerCase().trim()?i=e.strings.give:"take"===String(i).toLowerCase().trim()?i=e.strings.take:i&&"drop"!==String(i).toLowerCase().trim()||(i=e.strings.drop),$(document.createElement(r?"button":"a")).addClass("all-link drop-link").wiki(i+" all").ariaClick((function(){t.isEmpty()||n((function(){a&&e.is(a)?(a.merge(t),t.empty()):t.empty(),Dialog.close()}),(function(){Dialog.close()}),!0)}))}function a(a){var s,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{description:!0,use:!0,transfer:null,drop:!0,all:!0,stack:!0,dropActionText:"",classes:""},u=$(document.createElement("ul")).addClass("simple-inventory-list");if(a.length){if(s=a.list.map((function(r){var s=[],u=t.has(r)&&t.get(r).displayName?t.get(r).displayName:r;o.description&&t.has(r)&&t.get(r).description?s.push(function(n,i,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return r=r||e.strings.inspect,$(document.createElement(a?"button":"a")).addClass("inspect-link").wiki(""+i).ariaClick((function(){t.get(i).inspect()}))}(a,r,u)):s.push($(document.createElement("span")).append(t.has(r)?t.get(r).name:r).addClass("item-name")),s.push(function(t,n,i,r){var a=$(document.createElement("span")),s=t.count(n);return i=i||e.strings.stackPre,r=r||e.strings.stackPost,1==s?a.addClass("item-count single"):a.addClass("item-count multi"),a.append(""+i+(s||0)+r)}(a,r)),o.use&&t.has(r)&&t.get(r).handler?s.push(function(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return i=i||e.strings.use,$(document.createElement(r?"button":"a")).addClass("use-link").wiki(""+i).ariaClick((function(){t.use(n)}))}(a,r)):s.push(i()),(o.transfer&&e.is(o.transfer)||o.drop)&&!function(e){return t.has(e)&&t.get(e).permanent}(r)?(s.push(function(t,i,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return"give"===String(r).toLowerCase().trim()?r=e.strings.give:"take"===String(r).toLowerCase().trim()?r=e.strings.take:r&&"drop"!==String(r).toLowerCase().trim()||(r=e.strings.drop),$(document.createElement(a?"button":"a")).addClass("drop-link").wiki(""+r).ariaClick((function(){n((function(){s&&e.is(s)?t.transfer(s,i,1):t.drop(i,1),Dialog.close()}),(function(){Dialog.close()}))}))}(a,r,o.dropActionText,!1,o.transfer||null)),a.count(r)>1&&o.stack?s.push(function(t,i,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return"give"===String(r).toLowerCase().trim()?r=e.strings.give:"take"===String(r).toLowerCase().trim()?r=e.strings.take:r&&"drop"!==String(r).toLowerCase().trim()||(r=e.strings.drop),r=r+"&nbsp;"+e.strings.stack,$(document.createElement(a?"button":"a")).addClass("stack-link drop-link").wiki(""+r).ariaClick((function(){n((function(){s&&e.is(s)?t.transfer(s,i,t.count(i)):t.drop(i,t.count(i)),Dialog.close()}),(function(){Dialog.close()}))}))}(a,r,o.dropActionText,!1,o.transfer||null)):s.push(i())):s.push(i());var l=r.normalize().toLowerCase().replace(/\s+/g,"-");return $(document.createElement("li")).append(s).addClass("simple-inventory-listing").attr({"data-item-id":l,"data-keyword":u})})),o.all){var l=$(document.createElement("li")).addClass("all-listing simple-inventory-listing").append([i("&mdash;"),i(),i(),r(a,o.dropActionText,!1,o.transfer||null)]);s.push(l)}}else s=$(document.createElement("li")).addClass("simple-inventory-listing").append($(document.createElement("span")).wiki(e.emptyMessage));return u.append(s),u}e.prototype.interface=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this,r=$(document.createElement("div")).addClass("simple-inventory-wrapper");return e.filter&&r.append(function(){var t=$(document.createElement("div")).addClass("simple-inventory-filter"),e=$(document.createElement("input")).attr({type:"text",placeholder:"Filter..."}).on("input",(function(){var n=e.val().trim().toLowerCase(),i=t.parent().find("ul.simple-inventory-list li.simple-inventory-listing:not(.all-listing)");n?i.each((function(t,e){var i=$(e);i&&i.length&&(i.attr("data-keyword").substring(0,n.length).trim().toLowerCase()!==n?i.hide():i.show())})):i.show()}));return t.append(e),t}()),r.append(a(this,e)),$(document).on(":inventory-update.simple-inventory.gui-built-in",(function(){r.length?r.empty().append(a(i,e)):$(document).off(":inventory-update.simple-inventory.gui-built-in")})),n&&n instanceof $?t=n:n&&(t=$(n)),t&&r.appendTo(t),r}}(),function(){setup.Inventory,setup.Item;var t=".simple-inventory-userland",e=":inventory-update.simple-inventory"+t,n=":inventory-use.simple-inventory"+t;function i(t){return t&&"function"==typeof t}Object.assign(setup.Inventory,{events:{update:{on:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";i(t)&&$(document).on(e+n,t)},one:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";i(t)&&$(document).one(e+n,t)},off:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";$(document).off(e+t)}},use:{on:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";i(t)&&$(document).on(n+e,t)},one:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";i(t)&&$(document).one(n+e,t)},off:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";$(document).off(n+t)}}}})}(),function(){var t=":";function e(e){var n=function(t){return t.replace(/\r+/g,"\n").replace(/\n+/,"\n").replace(/ +/g," ").trim().split(/\n/g)}(e),i={};return n.forEach((function(e){if(e&&e.trim()&&e.includes(t)){var n=e.trim().split(t);i[n[0].trim()]=n[1].trim()}})),i}var n=function(t){try{return Story.has(t)?e(Story.get(t).text):{}}catch(t){return console.error(t.message,t),{}}}("inventory.strings");n.empty&&"string"==typeof n.empty&&n.empty.trim()&&(setup.Inventory.emptyMessage=n.empty,delete n.empty),setup.Inventory.strings=n||{}}(),function(){var t=setup.Item,e=setup.Inventory;function n(t){return t&&"string"==typeof t&&t.length>=2&&("$"===t[0]||"_"===t[0])}function i(t){if(n(t)&&(t=State.getVar(t)),e.is(t))return t}Macro.add(["item","consumable"],{tags:["description","tags","unique","permanent"],handler:function(){var e,n,i,r,a=null,s=!1,o=!1,u=!1;if(State.length>0)return this.error("items must be defined in `StoryInit` or story JavaScript!");if(!this.args[0]||"string"!=typeof this.args[0]||!this.args[0].trim())return this.error("invalid item ID");if(e=this.args[0].trim(),"consumable"===this.name&&(a=this.payload[0].contents||null,s=!0),this.args[1]&&(n=this.args[1]),this.payload.length>1){var l=this.payload.find((function(t){return"description"===t.name})),c=this.payload.find((function(t){return"tags"===t.name})),d=this.payload.find((function(t){return"unique"===t.name})),f=this.payload.find((function(t){return"permanent"===t.name}));l&&(i=l.contents.trim()),c&&(r=c.args.flat(1/0)),d&&(o=!0),f&&(u=!0)}t.add(e,{displayName:n||"",description:i||"",handler:a,consumable:s,unique:o,permanent:u},r)}}),Macro.add("newinv",{handler:function(){var t=this.args.raw.trim().split(" ").first().replace(/["']/g,"").trim();if(!n(t))return this.error("argument must be a story or temporary variable!");State.setVar(t,new e({},this.args.flat(1/0).slice(1)))}}),Macro.add(["pickup","drop"],{handler:function(){var t=i(this.args[0]);return t?this.args.length<3?this.error("no items to pick up were provided"):void t[this.name](this.args.slice(1)):this.error("first argument must be a valid inventory!")}}),Macro.add("dropall",{handler:function(){var t=i(this.args[0]);if(!t)return this.error("first argument must be a valid inventory!");t.empty()}}),Macro.add(["transfer","merge","unmerge"],{handler:function(){var t=i(this.args[0]);if(!t)return this.error("first argument must be a valid inventory!");var e=i(this.args[1]);if(!e)return this.error("second argument must be a valid inventory!");if("transfer"===this.name){if(this.args.length<4)return this.error("no items to transfer were provided");t.transfer(e,this.args.slice(2))}else t[this.name](e)}}),Macro.add(["inv","take","give"],{handler:function(){var t=null,n=i(this.args[0]);if(!n)return this.error("first argument must be a valid inventory!");this.args[1]&&i(this.args[1])&&(t=i(this.args[1]));var r={description:this.args.includesAny("inspect","description"),use:this.args.includes("use"),transfer:t,drop:this.args.includes("drop"),all:this.args.includes("all"),stack:this.args.includes("stack"),filter:this.args.includes("filter"),dropActionText:"inv"===this.name?"Drop":e.strings[this.name.trim().toLowerCase()],classes:"macro-".concat(this.name)};n.interface(r,$(this.output))}})}(),function(){var t=setup.Item,e=setup.Inventory;function n(t,e,n){if("object"!==_typeof(e))throw new TypeError("the extension should be a plain generic object holding the properties and methods you want to add");Object.keys(e).forEach((function(i){if(t[i]&&!n)throw new Error('Cannot override existing property "'+i+'"!');t[i]=e[i]}))}Object.assign(e,{extend:function(t){n(e,t,arguments.length>1&&void 0!==arguments[1]&&arguments[1])},extendPrototype:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n(e.prototype,t,i)}}),Object.assign(t,{extend:function(e){n(t,e,arguments.length>1&&void 0!==arguments[1]&&arguments[1])},extendPrototype:function(e){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n(t.prototype,e,i)}})}();
// End Simple Inventory


Macro.add('image', {
    handler: function () {
        // Check if there is exactly one argument provided, which should be the image path
        if (this.args.length !== 1) {
            return this.error('This macro requires exactly one argument: the image path.');
        }
        const imagePath = this.args[0];
        
        // Create a new div element to act as the container
        const container = document.createElement('div');
        container.className = 'imageContainer';

        // Create the image element
        const image = document.createElement('img');
        image.src = imagePath;

        // Append the image to the container
        container.appendChild(image);

        // Append the container to the output of the macro
        $(this.output).append(container);
    }
});

:: StoryStylesheet [stylesheet]
/* notify.min.css, by chapel; for use with notify.js; v1.0.0 */
#notify{position:fixed;display:block;width:16em;right:-20em;top:2em;padding:.5em;background-color:#fff;color:#000;-webkit-transition:right .3s;-moz-transition:right .3s;-o-transition:right .3s;transition:right .3s}#notify.open{right:0}
/* end notify.min.css */
/* speech.min.css, by chapel; for use with speech.js */
.say{border:1px solid #eee;overflow:auto}.say img{max-width:20%;float:left;margin-right:1em}.say p:first-of-type{font-weight:700;margin:.2em 0;border-bottom:1px solid #eee}.say p:last-of-type{padding:.5em;margin:0}
/* popover.min.css, by chapel; for use with popover.js; v1.0.0 */
#ui-dialog-body.popover{background:0 0;border:0;padding:0}.popover #ui-dialog-titlebar{background:0 0}.popover #ui-dialog-title{display:none}.popover #ui-dialog-close{position:fixed;display:block;top:0;right:0;height:3em}.popover #ui-dialog-close:hover{background-color:transparent;border-color:transparent;color:#c22}#ui-overlay.popover.opaque{opacity:1}#ui-overlay.popover.transparent{opacity:0}#ui-overlay.popover.invert{background-color:#f8f8f8}#ui-dialog-body.popover.invert{color:#111}
/* end popover.min.css */



/*images*/
tw-story[tags~="1"] {
  background-image:url("./images/image30.jpg");
  background-size:cover;
}

:root {
  --light-main: #f3d9b1;
  --light-contrast: #dbb888;
  --contrast: #747443;
  --dark-contrast: #505946;
  --main: #8f9779;
  --dark-main: #5b605e;
  --darker-main: #5b605e;
  --dark: #0e0502;
}

* {
  box-sizing: border-box;
}

*:hover {
  transition: all 0.3s ease;
}

@font-face {
  font-family: "AncientScript";
  src: url("fonts/ancientscript.ttf") format("truetype");
}

@font-face {
  font-family: "Social Media Circled";
  src: url(fonts/Social-Media-Circled.otf);
}
@font-face {
  font-family: "Neothic";
  src: url(fonts/Neothic.ttf);
}
@font-face {
  font-family: "Dyslexic";
  src: url(fonts/OpenDyslexic-Regular.otf) format("opentype");
  font-style: normal;
  font-weight: 400;
}
@font-face {
  font-family: "Dyslexic";
  src: url(fonts/OpenDyslexic-Italic.otf) format("opentype");
  font-style: italic;
  font-weight: 400;
}
@font-face {
  font-family: "Dyslexic";
  src: url(fonts/OpenDyslexic-BoldItalic.otf) format("oopentypet");
  font-style: italic;
  font-weight: 700;
}
@font-face {
  font-family: "Dyslexic";
  src: url(fonts/OpenDyslexic-Bold.otf) format("opentype");
  font-style: normal;
  font-weight: 700;
}
body {
  margin: 0;
  color: #111;
  background-color: #efe0cb;
  font-family: "Montserrat", sans-serif;
}

body, #passages {
  font-family: "AncientScript", "Montserrat", sans-serif;
}

a, a:hover, a:link, a:visited, a:active {
  text-decoration: none;
  transition: all 0.3s ease;
}

#sidebar-title {
  font-size: 2.5rem; 
  color: #004444; 
  font-family: "Neothic", sans-serif; 
  text-align: center; 
  width: 100%; 
  padding: 20px 0; 
  margin: 0;
  position: relative; 
  border-bottom: 2px solid white;
  box-sizing: border-box;
}


#story {
  margin-top: 70px;
  padding: 30px;
  line-height: 1.5;
  overflow: scroll;
}
#story h1 {
  font-family: "Neothic", serif;
  text-transform: uppercase;
  color:#004444;
}
#story h2 {
  font-family: "Neothic", serif;
  color: var(--contrast);
  text-transform: uppercase;
}
#story h3 {
  color: var(--dark-main);
  text-transform: uppercase;
  letter-spacing: 2px;
  font-weight: normal;
}
#story hr::before {
  content: "";
  display: block;
  height: 2px;
  width: 100%;
  background-color: var(--light-main);
  margin: 0 auto 15px;
}
#story hr {
  border: 0;
}
#story ul {
  list-style-type: none;
  padding: 0 10px;
}
#story ul li {
  border-left: 5px solid var(--contrast);
  padding-left: 15px;
  margin: 5px 0;
}
#story .link-internal, #story .link-internal:visited {
  color: var(--main);
  margin: 10px 0;
  font-weight: bold;
  transition: 0.3s ease-in-out;
}
#story .link-internal.macro-button {
  width: 100%;
  padding: 12px 0 13px;
  background-color: var(--dark-main);
  color: white;
  font-weight: normal;
  text-transform: uppercase;
  font-size: 1rem;
  letter-spacing: 2px;
  border: none;
  transition: 0.3s ease-in-out;
  margin: 20px 0;
}
#story .macro-cycle {
  color: var(--contrast);
  font-style: italic;
}
#story .macro-cycle:hover {
  color: var(--main);
}
#story .macro-listbox {
  background-color: var(--main);
  color: white;
  border-color: var(--light-main);
  padding: 5px;
}
#story .macro-textarea {
  border-color: var(--light-main);
  background-color: var(--main);
  color: white;
  resize: none;
  padding: 5px;
}
#story .macro-textbox {
  background-color: var(--main);
  border: 1px solid var(--light-main);
  color: white;
  padding: 5px;
}

#story .link-internal.macro-button, #story .link-internal:hover {
  border: 0px solid var(--dark-main);
  text-shadow: 1px 1px var(--dark); 
}

#passages {
  max-width: 600px;
  margin: 0 auto;
  font-family: "Dyslexic";
}

#sidebar {
  position: fixed;
  padding: 0; 
  overflow: scroll;
  top: 0;
  left: 0;
  background-color: var(--main);
  color: white;
  width: 100%;
  height: 70px;
  transition: all 0.3s ease;
  box-sizing: border-box;
}

.sidebar-header {
  width: 100%;
  height: auto;
  display: flex;
  justify-content: center;
  align-items: center;
}

.sidebar-header .story-title {
  font-size: 1rem;
  color: #004444;
  text-align: center;
  font-family: "Neothic";
  text-transform: uppercase;
  letter-spacing: 2px;
  font-weight: bold;
}
.sidebar-header .sidebar-toggle {
  width: 20%;
  font-size: 30px;
  text-align: center;
}

#sidebar-body {
  padding: 20px;
  display: none;
}
#sidebar-body .story-logo {
  text-align: center;
}
#sidebar-body .story-logo img {
  max-width: 60%;
}
#sidebar-body .story-author {
  margin: 2vh 0;
  font-size: 0.8rem;
  letter-spacing: 2px;
  text-transform: uppercase;
  text-align: center;
  font-weight: normal;
}
#sidebar-body .story-author a {
  color: var(--darker-main);
  border-bottom: 1px solid white;
  padding-bottom: 4px;
}

.sidebar-history-nav {
  display: flex;
  justify-content: center;
  align-items: center;
}
.sidebar-history-nav span {
  background-color: var(--darker-main);
  color: white;
  width: 40px;
  height: 40px;
  margin: 0 5px;
  padding: 0.75rem 0 0 0.75rem;
  border-radius: 50%;
}

.story-menu {
  margin: 7vh 0;
  list-style-type: none;
  text-transform: uppercase;
  letter-spacing: 1px;
  font-size: 1.1rem;
}
.story-menu li {
  margin: 10px 0;
  border-left: 5px solid var(--darker-main);
  padding-left: 15px;
}
.story-menu li a, .story-menu li a:visited {
  color: white;
}

.story-tools {
  margin: 8vh 20px;
  list-style-type: none;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0;
  font-size: 20px;
}
.story-tools li {
  position: relative;
  color: white;
  margin: 0 7px;
  background-color: var(--darker-main);
  border-radius: 50%;
  width: 40px;
  height: 40px;
  padding: 0.6rem 0 0 0.65rem;
}
.story-tools li .tooltiptext::before {
  visibility: hidden;
  content: "";
  position: absolute;
  bottom: 100%;
  left: 42%;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent white transparent;
  transition: all 0;
}
.story-tools li .tooltiptext {
  visibility: hidden;
  position: absolute;
  left: -1.3rem;
  top: 125%;
  background-color: white;
  color: var(--dark);
  text-align: center;
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 1px;
  width: 5.1rem;
  border-radius: 10px;
  padding: 0.5rem 0.4rem 0.4rem;
}

#social-media p {
  text-align: center;
  text-transform: uppercase;
  letter-spacing: 1px;
}
#social-media ul {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0;
  list-style-type: none;
  font-family: "Social Media Circled";
  font-size: 30px;
}
#social-media ul li {
  margin: 0 5px;
}
#social-media ul li a {
  color: var(--darker-main);
}

#sidebar.toggled {
  height: 100vh;
}

#sidebar.toggled #sidebar-body {
  display: block;
}

#ui-overlay {
  position: fixed;
  width: 100vw;
  height: 100vh;
  top: 0;
  left: 0;
  background-color: var(--main);
  opacity: 0.6;
  z-index: 3;
  overflow: hidden;
}

#ui-dialog {
  position: absolute;
  top: 0;
  left: 0;
  width: 90vw;
  height: auto;
  z-index: 4;
  background-color: var(--dark-main);
  padding: 20px;
  margin: -16px 0 0 -16px;
}
#ui-dialog select {
  background-color: var(--main);
  padding: 7px;
  color: white;
  border: var(--light-main);
  font-size: 1rem;
}

#ui-dialog-titlebar {
  background-color: white;
  position: relative;
  padding: 30px 20px;
}
#ui-dialog-titlebar h1 {
  font-family: "Neothic", serif;
  text-transform: uppercase;
  color: var(--main);
  width: 100%;
  text-align: center;
  padding: 0;
}

#ui-dialog-close {
  position: absolute;
  background-color: transparent;
  width: auto;
  height: auto;
  border: none;
  color: var(--dark-main);
  top: 15px;
  right: 15px;
  font-size: 30px;
}

#ui-dialog-body {
  width: 100%;
  height: auto;
  background-color: white;
  padding: 20px;
  margin: 20px 0;
  border: none;
  color: #111;
}
#ui-dialog-body button {
  background-color: var(--main);
  border: none;
  color: white;
  padding: 12px 0;
  width: 100%;
}
#ui-dialog-body button:hover {
  background-color: var(--dark-contrast);
}
#ui-dialog-body ul.buttons {
  list-style-type: none;
  padding: 0;
  margin: 3vh 0 2vh;
}
#ui-dialog-body ul.buttons li {
  margin: 10px 0;
  display: block;
  width: 100%;
}
#ui-dialog-body ul.buttons button {
  background-color: var(--main);
  text-transform: uppercase;
  letter-spacing: 1px;
  width: 100%;
}
#ui-dialog-body ul.buttons button:hover {
  background-color: var(--dark-contrast);
}
#ui-dialog-body ul.buttons > li + li > button {
  margin-left: 0;
}

@media only screen and (min-width: 768px) {
  #passages {
    max-width: 900px;
    margin: 0 auto;
  }

  #sidebar-body .story-logo img {
    max-width: 450px;
  }

  #sidebar.toggled #sidebar-body {
    max-width: 800px;
    margin: 0 auto;
  }

  #ui-dialog {
    max-width: 900px;
  }
}
@media only screen and (min-width: 1000px) {
  #sidebar {
    width: 400px;
    height: 100vh;
    transition: margin-left 0.3s;
  }

  .sidebar-header .sidebar-toggle span {
    transition: 0.3s ease-in-out;
  }

  .sidebar-header .sidebar-toggle span:hover {
    color: var(--darker-main);
    font-size: 31px;
  }

  .sidebar-history-nav span:hover {
    background-color: var(--dark);
  }

  #sidebar-body {
    display: block;
    padding: 0 50px 0;
  }

  #sidebar-body .story-logo {
    cursor: pointer;
  }

  #sidebar-body .story-logo img:hover {
    transform: scale(1.1);
  }

  #sidebar-body .story-logo img {
    max-width: 100%;
    transition: 0.3s ease-in-out;
  }

  #sidebar-body .story-author a:hover {
    color: var(--dark);
    letter-spacing: 3px;
  }

  .story-tools li {
    transition: none;
  }

  .story-tools li:hover {
    background-color: var(--dark);
    color: white;
  }

  .story-tools li:hover .tooltiptext, .story-tools li:hover .tooltiptext::before {
    visibility: visible;
  }

  .story-menu li:hover {
    border-color: var(--dark);
  }

  .story-menu li:hover a {
    color: var(--dark);
  }

  #social-media ul li a:hover {
    color: var(--dark);
  }

  #sidebar.toggled {
    margin-left: -343px;
  }

  #sidebar.toggled ~ #story {
    padding-left: 30px;
  }

  #story {
    padding: 4vh 4vw 4vh 440px;
    margin: 0;
  }

  #story .link-internal:hover {
    color: var(--contrast);
  }

  #story .link-internal.macro-button:hover {
    background-color: var(--contrast);
    letter-spacing: 3px;
    color: white;
  }

  #passages {
    max-width: 900px;
  }

  #ui-dialog-close:hover {
    color: var(--contrast);
    background-color: transparent;
    border: none;
  }

}
html.dark body {
  background-color: var(--dark);
  color: white;
}
html.dark #sidebar {
  background-color: var(--dark-main);
}
html.dark #sidebar-body .story-author a {
  border-color: var(--dark);
}
html.dark .story-tools li {
  background-color: var(--dark);
  color: white;
}
html.dark #social-media li a {
  color: var(--dark);
}
html.dark #story h3 {
  color: var(--light-main);
}
html.dark #story hr::before {
  background-color: var(--contrast);
}
html.dark #story ul li {
  border-left-color: var(--main);
}
html.dark #story .link-internal, html.dark #story .link-internal:visited {
  color: var(--contrast);
}
html.dark #story .link-internal.macro-button {
  color: white;
}
html.dark #ui-overlay {
  background-color: var(--dark);
}
html.dark #ui-dialog {
  background-color: var(--dark-main);
}
html.dark #ui-dialog-titlebar {
  background-color: var(--dark);
}
html.dark #ui-dialog-titlebar h1 {
  color: var(--light-main);
}
html.dark #ui-dialog-close {
  color: var(--light-main);
}
html.dark #ui-dialog-body {
  background-color: var(--dark);
  color: var(--light-main);
}
html.dark #ui-dialog-body button {
  background-color: var(--main);
  color: var(--light-main);
}

@media only screen and (min-width: 1000px) {
  html.dark .sidebar-header .sidebar-toggle span:hover {
    color: var(--dark);
  }
  html.dark #sidebar-body .story-author a:hover {
    color: var(--dark);
    border-color: var(--light-main);
  }
  html.dark .story-tools li:hover {
    background-color: var(--dark-contrast);
  }
  html.dark .story-tools .tooltiptext {
    color: var(--dark);
  }
  html.dark .story-menu li:hover {
    border-color: var(--dark);
  }
  html.dark .story-menu li:hover a {
    color: var(--dark);
  }
  html.dark #social-media li a:hover {
    color: white;
  }
  html.dark #story .link-internal:hover {
    color: var(--main);
  }
  html.dark #story .link-internal.macro-button:hover {
    background-color: var(--dark-contrast);
    color: white;
  }
  html.dark #story .macro-cycle {
    color: var(--main);
    font-style: italic;
  }
  html.dark #story .macro-cycle:hover {
    color: var(--contrast);
  }
  html.dark #ui-dialog-close:hover {
    color: var(--contrast);
  }
  html.dark #ui-dialog-body button:hover {
    background-color: var(--darker-main);
  }
  

}

/* Simple Inventory, for SugarCube 2, by Chapel
v3.0.0, 2024-02-20, 1d95a49488446cafefaa956e53345395394e4b51 */
ul.simple-inventory-list{margin:0 auto;padding:0}.simple-inventory-listing{list-style:none;padding:.3rem .3rem .3rem 1rem;display:grid;grid-template-columns:1fr 1fr 1fr 1fr 1fr}.simple-inventory-listing:nth-child(2n){background-color:#000}.simple-inventory-listing>a,.simple-inventory-listing>span{display:inline-block}.all-listing.simple-inventory-listing{border-top:1px solid #fafafa;background-color:transparent}.drop-link{color:#e33}.drop-link:active,.drop-link:focus,.drop-link:hover{color:#f88}.simple-inventory-filter{text-align:right}.simple-inventory-filter input{display:inline-block}
/* End Simple Inventory */


.imageContainer {
width: 100%; height: 400px; display: flex; justify-content: center; align-items: center; overflow: hidden;}